function sound(){var t=0;t>0&&(document.getElementById("sound-file").currentTime=0),document.getElementById("sound-file").play(),t=1}THREE.TrackballControls=function(t,e){function n(t){h.enabled!==!1&&(window.removeEventListener("keydown",n),m=f,f===p.NONE&&(t.keyCode!==h.keys[p.ROTATE]||h.noRotate?t.keyCode!==h.keys[p.ZOOM]||h.noZoom?t.keyCode!==h.keys[p.PAN]||h.noPan||(f=p.PAN):f=p.ZOOM:f=p.ROTATE))}function i(t){h.enabled!==!1&&(f=m,window.addEventListener("keydown",n,!1))}function o(t){h.enabled!==!1&&(t.preventDefault(),t.stopPropagation(),f===p.NONE&&(f=t.button),f!==p.ROTATE||h.noRotate?f!==p.ZOOM||h.noZoom?f!==p.PAN||h.noPan||(x=M=h.getMouseOnScreen(t.clientX,t.clientY)):b=w=h.getMouseOnScreen(t.clientX,t.clientY):g=y=h.getMouseProjectionOnBall(t.clientX,t.clientY),document.addEventListener("mousemove",r,!1),document.addEventListener("mouseup",s,!1))}function r(t){h.enabled!==!1&&(t.preventDefault(),t.stopPropagation(),f!==p.ROTATE||h.noRotate?f!==p.ZOOM||h.noZoom?f!==p.PAN||h.noPan||(M=h.getMouseOnScreen(t.clientX,t.clientY)):w=h.getMouseOnScreen(t.clientX,t.clientY):y=h.getMouseProjectionOnBall(t.clientX,t.clientY))}function s(t){h.enabled!==!1&&(t.preventDefault(),t.stopPropagation(),f=p.NONE,document.removeEventListener("mousemove",r),document.removeEventListener("mouseup",s))}function a(t){if(h.enabled!==!1){t.preventDefault(),t.stopPropagation();var e=0;t.wheelDelta?e=t.wheelDelta/40:t.detail&&(e=-t.detail/3),b.y+=.01*e}}function c(t){if(h.enabled!==!1)switch(t.touches.length){case 1:f=p.TOUCH_ROTATE,g=y=h.getMouseProjectionOnBall(t.touches[0].pageX,t.touches[0].pageY);break;case 2:f=p.TOUCH_ZOOM;var e=t.touches[0].pageX-t.touches[1].pageX,n=t.touches[0].pageY-t.touches[1].pageY;_=E=Math.sqrt(e*e+n*n);break;case 3:f=p.TOUCH_PAN,x=M=h.getMouseOnScreen(t.touches[0].pageX,t.touches[0].pageY);break;default:f=p.NONE}}function u(t){if(h.enabled!==!1)switch(t.preventDefault(),t.stopPropagation(),t.touches.length){case 1:y=h.getMouseProjectionOnBall(t.touches[0].pageX,t.touches[0].pageY);break;case 2:var e=t.touches[0].pageX-t.touches[1].pageX,n=t.touches[0].pageY-t.touches[1].pageY;_=Math.sqrt(e*e+n*n);break;case 3:M=h.getMouseOnScreen(t.touches[0].pageX,t.touches[0].pageY);break;default:f=p.NONE}}function l(t){if(h.enabled!==!1){switch(t.touches.length){case 1:g=y=h.getMouseProjectionOnBall(t.touches[0].pageX,t.touches[0].pageY);break;case 2:E=_=0;break;case 3:x=M=h.getMouseOnScreen(t.touches[0].pageX,t.touches[0].pageY)}f=p.NONE}}var h=this,p={NONE:-1,ROTATE:0,ZOOM:1,PAN:2,TOUCH_ROTATE:3,TOUCH_ZOOM:4,TOUCH_PAN:5};this.object=t,this.domElement=void 0!==e?e:document,this.enabled=!0,this.screen={width:0,height:0,offsetLeft:0,offsetTop:0},this.radius=(this.screen.width+this.screen.height)/4,this.rotateSpeed=1,this.zoomSpeed=1.2,this.panSpeed=.3,this.noRotate=!1,this.noZoom=!1,this.noPan=!1,this.staticMoving=!1,this.dynamicDampingFactor=.2,this.minDistance=0,this.maxDistance=1/0,this.keys=[65,83,68],this.target=new THREE.Vector3;var d=new THREE.Vector3,f=p.NONE,m=p.NONE,v=new THREE.Vector3,g=new THREE.Vector3,y=new THREE.Vector3,b=new THREE.Vector2,w=new THREE.Vector2,E=0,_=0,x=new THREE.Vector2,M=new THREE.Vector2;this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.up0=this.object.up.clone();var T={type:"change"};this.handleResize=function(){this.screen.width=window.innerWidth,this.screen.height=window.innerHeight,this.screen.offsetLeft=0,this.screen.offsetTop=0,this.radius=(this.screen.width+this.screen.height)/4},this.handleEvent=function(t){"function"==typeof this[t.type]&&this[t.type](t)},this.getMouseOnScreen=function(t,e){return new THREE.Vector2((t-h.screen.offsetLeft)/h.radius*.5,(e-h.screen.offsetTop)/h.radius*.5)},this.getMouseProjectionOnBall=function(t,e){var n=new THREE.Vector3((t-.5*h.screen.width-h.screen.offsetLeft)/h.radius,(.5*h.screen.height+h.screen.offsetTop-e)/h.radius,0),i=n.length();i>1?n.normalize():n.z=Math.sqrt(1-i*i),v.copy(h.object.position).sub(h.target);var o=h.object.up.clone().setLength(n.y);return o.add(h.object.up.clone().cross(v).setLength(n.x)),o.add(v.setLength(n.z)),o},this.rotateCamera=function(){var t=Math.acos(g.dot(y)/g.length()/y.length());if(t){var e=(new THREE.Vector3).crossVectors(g,y).normalize(),n=new THREE.Quaternion;t*=h.rotateSpeed,n.setFromAxisAngle(e,-t),v.applyQuaternion(n),h.object.up.applyQuaternion(n),y.applyQuaternion(n),h.staticMoving?g.copy(y):(n.setFromAxisAngle(e,t*(h.dynamicDampingFactor-1)),g.applyQuaternion(n))}},this.zoomCamera=function(){if(f===p.TOUCH_ZOOM){var t=E/_;E=_,v.multiplyScalar(t)}else{var t=1+(w.y-b.y)*h.zoomSpeed;1!==t&&t>0&&(v.multiplyScalar(t),h.staticMoving?b.copy(w):b.y+=(w.y-b.y)*this.dynamicDampingFactor)}},this.panCamera=function(){var t=M.clone().sub(x);if(t.lengthSq()){t.multiplyScalar(v.length()*h.panSpeed);var e=v.clone().cross(h.object.up).setLength(t.x);e.add(h.object.up.clone().setLength(t.y)),h.object.position.add(e),h.target.add(e),h.staticMoving?x=M:x.add(t.subVectors(M,x).multiplyScalar(h.dynamicDampingFactor))}},this.checkDistances=function(){h.noZoom&&h.noPan||(h.object.position.lengthSq()>h.maxDistance*h.maxDistance&&h.object.position.setLength(h.maxDistance),v.lengthSq()<h.minDistance*h.minDistance&&h.object.position.addVectors(h.target,v.setLength(h.minDistance)))},this.update=function(){v.subVectors(h.object.position,h.target),h.noRotate||h.rotateCamera(),h.noZoom||h.zoomCamera(),h.noPan||h.panCamera(),h.object.position.addVectors(h.target,v),h.checkDistances(),h.object.lookAt(h.target),d.distanceToSquared(h.object.position)>0&&(h.dispatchEvent(T),d.copy(h.object.position))},this.reset=function(){f=p.NONE,m=p.NONE,h.target.copy(h.target0),h.object.position.copy(h.position0),h.object.up.copy(h.up0),v.subVectors(h.object.position,h.target),h.object.lookAt(h.target),h.dispatchEvent(T),d.copy(h.object.position)},this.domElement.addEventListener("contextmenu",function(t){t.preventDefault()},!1),this.domElement.addEventListener("mousedown",o,!1),this.domElement.addEventListener("mousewheel",a,!1),this.domElement.addEventListener("DOMMouseScroll",a,!1),this.domElement.addEventListener("touchstart",c,!1),this.domElement.addEventListener("touchend",l,!1),this.domElement.addEventListener("touchmove",u,!1),window.addEventListener("keydown",n,!1),window.addEventListener("keyup",i,!1),this.handleResize()},THREE.TrackballControls.prototype=Object.create(THREE.EventDispatcher.prototype);var DAT=DAT||{};DAT.Globe=function(t,e){function n(){t.style.color="#fff",t.style.font="13px/20px Arial, sans-serif";var e,n,r;E=t.offsetWidth||window.innerWidth,_=t.offsetHeight||window.innerHeight,y=new THREE.PerspectiveCamera(30,E/_,1,1e4),y.position.z=H,b=new THREE.Scene;var s=new THREE.SphereGeometry(200,40,30);e=C.earth,n=THREE.UniformsUtils.clone(e.uniforms),n.texture.value=THREE.ImageUtils.loadTexture("imgs/earth_dblue.png"),r=new THREE.ShaderMaterial({uniforms:n,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader}),x=new THREE.Mesh(s,r),x.rotation.y=Math.PI,x.position.set(0,0,0),b.add(x),e=C.atmosphere,n=THREE.UniformsUtils.clone(e.uniforms),r=new THREE.ShaderMaterial({uniforms:n,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader,side:THREE.BackSide,blending:THREE.AdditiveBlending,transparent:!0}),x=new THREE.Mesh(s,r),x.scale.set(1.1,1.1,1.1),b.add(x),s=new THREE.BoxGeometry(.3,.3,1),s.applyMatrix((new THREE.Matrix4).makeTranslation(0,0,-.5)),M=new THREE.Mesh(s),w=new THREE.WebGLRenderer({antialias:!0}),w.setSize(E,_),w.domElement.style.position="absolute",t.appendChild(w.domElement),t.addEventListener("mousedown",c,!1),t.addEventListener("mousewheel",p,!1),document.addEventListener("keydown",d,!1),window.addEventListener("resize",f,!1),t.addEventListener("mouseover",function(){T=!0},!1),t.addEventListener("mouseout",function(){T=!1},!1);var a=new i('<div class="text">South America</div>');a.position.set(-.73,-.25,-1).normalize().multiplyScalar(182),x.add(a);var u=new i('<div class="text">North America</div>');u.position.set(.2,.9,-1).normalize().multiplyScalar(182),x.add(u);var l=new i('<div class="text">Asia</div>');l.position.set(.45,.7,1).normalize().multiplyScalar(182),x.add(l);var h=new i('<div class="text">Africa</div>');h.position.set(-1,.25,.25).normalize().multiplyScalar(182),x.add(h);var m=new i('<div class="text">Australia</div>');m.position.set(.15,-.13,.15).normalize().multiplyScalar(182),x.add(m);var v=new i('<div class="text">Europe</div>');v.position.set(-.8,1,.3).normalize().multiplyScalar(182),x.add(v);var g=new i('<div class="text">Antarctica</div>');g.position.set(0,-1,0).normalize().multiplyScalar(182),x.add(g);var S=new i('<a href="http://www.hulu.jp/watch/597856" target="_blank" class="photo" style="display:block"><img src="imgs/原爆ドーム.png"></img></a>');S.position.set(.64,.655,.7).normalize().multiplyScalar(182),x.add(S);var j=new i('<a href="http://www.hulu.jp/watch/597839" target="_blank" class="photo" style="display:block"><img src="imgs/アンコールワット.png"></img></a>');j.position.set(.25,.3,1).normalize().multiplyScalar(182),x.add(j);var k=new i('<a href="http://www.hulu.jp/watch/597850" target="_blank" class="photo" style="display:block"><img src="imgs/タージマハル.png"></img></a>');k.position.set(-.25,.4,1).normalize().multiplyScalar(182),x.add(k);var P=new i('<a href="http://www.hulu.jp/watch/597849" target="_blank" class="photo" style="display:block"><img src="imgs/グレートバリアリーフ.png"></img></a>');P.position.set(.25,-.08,.15).normalize().multiplyScalar(182),x.add(P);var O=new i('<a href="http://www.hulu.jp/watch/552448" target="_blank" class="photo" style="display:block"><img src="imgs/エオリオ諸島.png"></img></a>');O.position.set(-1,.83,.25).normalize().multiplyScalar(182),x.add(O);var L=new i('<a href="http://www.hulu.jp/watch/597844" target="_blank" class="photo" style="display:block"><img src="imgs/エジプト.png"></img></a>');L.position.set(-1,.55,.65).normalize().multiplyScalar(182),x.add(L);var N=new i('<a href="http://www.hulu.jp/watch/597837" target="_blank" class="photo" style="display:block"><img src="imgs/ンゴロンゴロ自然保護区.png"></img></a>');N.position.set(-1,-.1,.7).normalize().multiplyScalar(182),x.add(N);var A=new i('<a href="http://www.hulu.jp/watch/570566" target="_blank" class="photo" style="display:block"><img src="imgs/イースター島.png"></img></a>');A.position.set(.35,-.53,-1).normalize().multiplyScalar(182),x.add(A);var R=new i('<a href="http://www.hulu.jp/watch/570577" target="_blank" class="photo" style="display:block"><img src="imgs/ガラパゴス諸島.png"></img></a>');R.position.set(0,0,-1).normalize().multiplyScalar(182),x.add(R);var I=new i('<a href="http://www.hulu.jp/watch/597855" target="_blank" class="photo" style="display:block"><img src="imgs/イグアス.png"></img></a>');I.position.set(-.73,-.58,-1).normalize().multiplyScalar(182),x.add(I),o()}function i(e){THREE.Object3D.call(this),this.popup=document.createElement("div"),this.popup.classList.add("balloon"),this.popup.innerHTML=e,this.addEventListener("added",function(){t.appendChild(this.popup)}.bind(this)),this.addEventListener("removed",function(){t.removeChild(this.popup)}.bind(this))}function o(){b.fog=new THREE.Fog(0,1100,1101),particleCount=5e3,S=new THREE.Geometry,texture=THREE.ImageUtils.loadTexture("imgs/star.png"),material_star=new THREE.PointCloudMaterial({size:10,map:texture,transparent:!0,blending:THREE.AdditiveBlending,depthTest:!1});for(var t=0;t<particleCount;t++){var e=2e3*Math.random()-1e3,n=2e3*Math.random()-1e3,i=2e3*Math.random()-1e3;particle=new THREE.Vector3(e,n,i),particle.velocity=new THREE.Vector3(Math.random(),-Math.random(),0),S.vertices.push(particle)}pointCloud=new THREE.PointCloud(S,material_star),pointCloud.sortParticles=!0,b.add(pointCloud)}function r(t,e){var n,i,o,r,s,c,u;if(e.animated=e.animated||!1,this.is_animated=e.animated,e.format=e.format||"magnitude","magnitude"===e.format)c=5,u=function(t,e){return k(t[e+4])};else{if("legend"!==e.format)throw"error: format not supported: "+e.format;c=4,u=function(t,e){return k(t[e+3])}}if(e.animated){if(void 0===this._baseGeometry)for(this._baseGeometry=new THREE.Geometry,s=0;s<t.length;s+=c){n=t[s+1],i=t[s+2],whName=t[s],console.log(t.length),r=u(t,s),o=0,a(n,i,o,r,this._baseGeometry);var l=document.getElementById("nameList");newDiv=document.createElement("div"),newDiv.innerHTML=whName,newDiv.className="whName",l.appendChild(newDiv)}void 0===this._morphTargetId?this._morphTargetId=0:this._morphTargetId+=1,e.name=e.name||"morphTarget"+this._morphTargetId}var h=new THREE.Geometry;for(s=0;s<t.length;s+=c)n=t[s+1],i=t[s+2],r=u(t,s),o=t[s+3],o=3.5*o,a(n,i,o,r,h);e.animated?this._baseGeometry.morphTargets.push({name:e.name,vertices:h.vertices}):this._baseGeometry=h}function s(){if(void 0!==this._baseGeometry){if(this.is_animated===!1)this.points=new THREE.Mesh(this._baseGeometry,new THREE.MeshBasicMaterial({color:16777215,vertexColors:THREE.FaceColors,morphTargets:!1}));else{if(this._baseGeometry.morphTargets.length<8){console.log("morphTargets.length: ",this._baseGeometry.morphTargets.length);var t=8-this._baseGeometry.morphTargets.length;console.log("padding",t);for(var e=0;t>=e;e++)console.log("padding",e),this._baseGeometry.morphTargets.push({name:"morphPadding"+e,vertices:this._baseGeometry.vertices})}this.points=new THREE.Mesh(this._baseGeometry,new THREE.MeshBasicMaterial({color:16777215,vertexColors:THREE.FaceColors,morphTargets:!0}))}b.add(this.points)}}function a(t,e,n,i,o){var r=(90-t)*Math.PI/180,s=(180-e)*Math.PI/180;M.position.x=200*Math.sin(r)*Math.cos(s),M.position.y=200*Math.cos(r),M.position.z=200*Math.sin(r)*Math.sin(s),M.lookAt(x.position),M.scale.z=Math.max(n,.1),M.updateMatrix();for(var a=0;a<M.geometry.faces.length;a++)M.geometry.faces[a].color=i;M.matrixAutoUpdate&&M.updateMatrix(),o.merge(M.geometry,M.matrix)}function c(e){e.preventDefault(),t.addEventListener("mousemove",u,!1),t.addEventListener("mouseup",l,!1),t.addEventListener("mouseout",h,!1),L.x=-e.clientX,L.y=e.clientY,R.x=A.x,R.y=A.y,t.style.cursor="move"}function u(t){O.x=-t.clientX,O.y=t.clientY;var e=H/1e3;A.x=R.x+.005*(O.x-L.x)*e,A.y=R.y+.005*(O.y-L.y)*e,A.y=A.y>z?z:A.y,A.y=A.y<-z?-z:A.y}function l(e){t.removeEventListener("mousemove",u,!1),t.removeEventListener("mouseup",l,!1),t.removeEventListener("mouseout",h,!1),t.style.cursor="auto"}function h(e){t.removeEventListener("mousemove",u,!1),t.removeEventListener("mouseup",l,!1),t.removeEventListener("mouseout",h,!1)}function p(t){return t.preventDefault(),T&&m(.3*t.wheelDeltaY),!1}function d(t){switch(t.keyCode){case 38:m(100),t.preventDefault();break;case 40:m(-100),t.preventDefault()}}function f(e){y.aspect=t.offsetWidth/t.offsetHeight,y.updateProjectionMatrix(),w.setSize(t.offsetWidth,t.offsetHeight)}function m(t){I-=t,I=I>1e3?1e3:I,I=350>I?350:I}function v(){requestAnimationFrame(v),g()}function g(){m(P),N.x=-.05*(+new Date-F)/1e3,N.x+=.5*(A.x-N.x)+5,N.y+=.1*(A.y-N.y),H+=.3*(I-H),y.position.x=H*Math.sin(N.x)*Math.cos(N.y),y.position.y=H*Math.sin(N.y),y.position.z=H*Math.cos(N.x)*Math.cos(N.y),y.lookAt(x.position),w.render(b,y),Leap.loop(function(t){var e=t.hands[0];e&&(N.x=e.palmPosition[0]/1e3,console.log(e.palmPosition[0]),y.position.x=H*Math.sin(N.x)*Math.cos(N.y),y.position.y=H*Math.sin(N.y),y.position.z=H*Math.cos(N.x)*Math.cos(N.y),y.lookAt(x.position),w.render(b,y))}),400>H?b.remove(pointCloud):b.add(pointCloud),material_star.opacity=1-(1e3-H)/500}e=e||{};var y,b,w,E,_,x,M,T,S,j,_,k=e.colorFn||function(t){var e=new THREE.Color;return e.setHSL(t,1,.5),e},C=(e.imgDir||"/globe/",{earth:{uniforms:{texture:{type:"t",value:null}},vertexShader:["varying vec3 vNormal;","varying vec2 vUv;","void main() {","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","vNormal = normalize( normalMatrix * normal );","vUv = uv;","}"].join("\n"),fragmentShader:["uniform sampler2D texture;","varying vec3 vNormal;","varying vec2 vUv;","void main() {","vec3 diffuse = texture2D( texture, vUv ).xyz;","float intensity = 1.05 - dot( vNormal, vec3( 0.0, 0.0, 1.0 ) );","vec3 atmosphere = vec3( 1.0, 1.0, 1.0 ) * pow( intensity, 3.0 );","gl_FragColor = vec4( diffuse + atmosphere, 1.0 );","}"].join("\n")},atmosphere:{uniforms:{},vertexShader:["varying vec3 vNormal;","void main() {","vNormal = normalize( normalMatrix * normal );","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["varying vec3 vNormal;","void main() {","float intensity = pow( 0.8 - dot( vNormal, vec3( 0, 0, 1.0 ) ), 12.0 );","gl_FragColor = vec4( 1.0, 1.0, 1.0, 1.0 ) * intensity;","}"].join("\n")}}),P=0,O={x:0,y:0},L={x:0,y:0},N={x:0,y:0},A={x:3*Math.PI/2,y:Math.PI/6},R={x:0,y:0},H=1e5,I=1e5,z=Math.PI/2;window.innerWidth/2,window.innerHeight/2;i.prototype=Object.create(THREE.Object3D.prototype),i.prototype.constructor=i,i.prototype.updateMatrixWorld=function(){var e=new THREE.Vector3,n=new THREE.Raycaster;return function(i){THREE.Object3D.prototype.updateMatrixWorld.call(this,i),e.set(0,0,0),this.localToWorld(e),n.ray.direction.copy(e),n.ray.origin.set(0,0,0),y.localToWorld(n.ray.origin),n.ray.direction.sub(n.ray.origin);var o=n.ray.direction.length();n.ray.direction.normalize();var r=n.intersectObject(b,!0);r.length&&r[0].distance<o?this.popup.style.display="none":(e.project(y),this.popup.style.display="",this.popup.style.left=(e.x+1)*t.offsetWidth/2-50+"px",this.popup.style.top=(1-e.y)*t.offsetHeight/2-50+"px")}}();var F=+new Date;return n(),this.animate=v,this.__defineGetter__("time",function(){return this._time||0}),this.__defineSetter__("time",function(t){var e=[],n=this.points.morphTargetDictionary;for(var i in n)i.indexOf("morphPadding")<0&&e.push(n[i]);e.sort();var o=e.length-1,r=t*o+1,s=Math.floor(r);for(j=0;j<e.length;j++)this.points.morphTargetInfluences[e[j]]=0;var a=s-1,c=r-s;a>=0&&(this.points.morphTargetInfluences[a]=1-c),this.points.morphTargetInfluences[s]=c,this._time=t}),this.addData=r,this.createPoints=s,this.renderer=w,this.scene=b,this},function(t,e){"object"==typeof exports?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(t)}(this,function(t){function e(t){this._targetElement=t,this._options={nextLabel:"Next &rarr;",prevLabel:"&larr; Back",skipLabel:"Skip",doneLabel:"Done",tooltipPosition:"bottom",tooltipClass:"",highlightClass:"",exitOnEsc:!0,exitOnOverlayClick:!0,showStepNumbers:!0,keyboardNavigation:!0,showButtons:!0,showBullets:!0,showProgress:!1,scrollToElement:!0,overlayOpacity:.8,positionPrecedence:["bottom","top","right","left"],disableInteraction:!1}}function n(t){var e=[],n=this;if(this._options.steps)for(var o=[],c=0,u=this._options.steps.length;u>c;c++){var l=i(this._options.steps[c]);if(l.step=e.length+1,"string"==typeof l.element&&(l.element=document.querySelector(l.element)),"undefined"==typeof l.element||null==l.element){var p=document.querySelector(".introjsFloatingElement");null==p&&(p=document.createElement("div"),p.className="introjsFloatingElement",document.body.appendChild(p)),l.element=p,l.position="floating"}null!=l.element&&e.push(l)}else{var o=t.querySelectorAll("*[data-intro]");if(o.length<1)return!1;for(var c=0,d=o.length;d>c;c++){var f=o[c],m=parseInt(f.getAttribute("data-step"),10);m>0&&(e[m-1]={element:f,intro:f.getAttribute("data-intro"),step:parseInt(f.getAttribute("data-step"),10),tooltipClass:f.getAttribute("data-tooltipClass"),highlightClass:f.getAttribute("data-highlightClass"),position:f.getAttribute("data-position")||this._options.tooltipPosition})}for(var v=0,c=0,d=o.length;d>c;c++){var f=o[c];if(null==f.getAttribute("data-step")){for(;;){if("undefined"==typeof e[v])break;v++}e[v]={element:f,intro:f.getAttribute("data-intro"),step:v+1,tooltipClass:f.getAttribute("data-tooltipClass"),highlightClass:f.getAttribute("data-highlightClass"),position:f.getAttribute("data-position")||this._options.tooltipPosition}}}}for(var y=[],b=0;b<e.length;b++)e[b]&&y.push(e[b]);if(e=y,e.sort(function(t,e){return t.step-e.step}),n._introItems=e,g.call(n,t)){r.call(n);t.querySelector(".introjs-skipbutton"),t.querySelector(".introjs-nextbutton");n._onKeyDown=function(e){if(27===e.keyCode&&1==n._options.exitOnEsc)a.call(n,t),void 0!=n._introExitCallback&&n._introExitCallback.call(n);else if(37===e.keyCode)s.call(n);else if(39===e.keyCode)r.call(n);else if(13===e.keyCode){var i=e.target||e.srcElement;i&&i.className.indexOf("introjs-prevbutton")>0?s.call(n):i&&i.className.indexOf("introjs-skipbutton")>0?a.call(n,t):r.call(n),e.preventDefault?e.preventDefault():e.returnValue=!1}},n._onResize=function(t){h.call(n,document.querySelector(".introjs-helperLayer")),h.call(n,document.querySelector(".introjs-tooltipReferenceLayer"))},window.addEventListener?(this._options.keyboardNavigation&&window.addEventListener("keydown",n._onKeyDown,!0),window.addEventListener("resize",n._onResize,!0)):document.attachEvent&&(this._options.keyboardNavigation&&document.attachEvent("onkeydown",n._onKeyDown),document.attachEvent("onresize",n._onResize))}return!1}function i(t){if(null==t||"object"!=typeof t||"undefined"!=typeof t.nodeType)return t;var e={};for(var n in t)e[n]=i(t[n]);return e}function o(t){this._currentStep=t-2,"undefined"!=typeof this._introItems&&r.call(this)}function r(){if(this._direction="forward","undefined"==typeof this._currentStep?this._currentStep=0:++this._currentStep,this._introItems.length<=this._currentStep)return"function"==typeof this._introCompleteCallback&&this._introCompleteCallback.call(this),void a.call(this,this._targetElement);var t=this._introItems[this._currentStep];"undefined"!=typeof this._introBeforeChangeCallback&&this._introBeforeChangeCallback.call(this,t.element),d.call(this,t)}function s(){if(this._direction="backward",0===this._currentStep)return!1;var t=this._introItems[--this._currentStep];"undefined"!=typeof this._introBeforeChangeCallback&&this._introBeforeChangeCallback.call(this,t.element),d.call(this,t)}function a(t){var e=t.querySelector(".introjs-overlay");if(null!=e){e.style.opacity=0,setTimeout(function(){e.parentNode&&e.parentNode.removeChild(e)},500);var n=t.querySelector(".introjs-helperLayer");n&&n.parentNode.removeChild(n);var i=t.querySelector(".introjs-tooltipReferenceLayer");i&&i.parentNode.removeChild(i);var o=t.querySelector(".introjs-disableInteraction");o&&o.parentNode.removeChild(o);var r=document.querySelector(".introjsFloatingElement");r&&r.parentNode.removeChild(r);var s=document.querySelector(".introjs-showElement");s&&(s.className=s.className.replace(/introjs-[a-zA-Z]+/g,"").replace(/^\s+|\s+$/g,""));var a=document.querySelectorAll(".introjs-fixParent");if(a&&a.length>0)for(var c=a.length-1;c>=0;c--)a[c].className=a[c].className.replace(/introjs-fixParent/g,"").replace(/^\s+|\s+$/g,"");window.removeEventListener?window.removeEventListener("keydown",this._onKeyDown,!0):document.detachEvent&&document.detachEvent("onkeydown",this._onKeyDown),this._currentStep=void 0}}function c(t,e,n,i){var o,r,s,a="";if(e.style.top=null,e.style.right=null,e.style.bottom=null,e.style.left=null,e.style.marginLeft=null,e.style.marginTop=null,n.style.display="inherit","undefined"!=typeof i&&null!=i&&(i.style.top=null,i.style.left=null),this._introItems[this._currentStep]){o=this._introItems[this._currentStep],a="string"==typeof o.tooltipClass?o.tooltipClass:this._options.tooltipClass,e.className=("introjs-tooltip "+a).replace(/^\s+|\s+$/g,"");var a=this._options.tooltipClass;currentTooltipPosition=this._introItems[this._currentStep].position,("auto"==currentTooltipPosition||"auto"==this._options.tooltipPosition)&&"floating"!=currentTooltipPosition&&(currentTooltipPosition=u.call(this,t,e,currentTooltipPosition));var c=y(t),l=y(e).height,h=m();switch(currentTooltipPosition){case"top":e.style.left="15px",e.style.top="-"+(l+10)+"px",n.className="introjs-arrow bottom";break;case"right":e.style.left=y(t).width+20+"px",c.top+l>h.height&&(n.className="introjs-arrow left-bottom",e.style.top="-"+(l-c.height-20)+"px"),n.className="introjs-arrow left";break;case"left":1==this._options.showStepNumbers&&(e.style.top="15px"),c.top+l>h.height?(e.style.top="-"+(l-c.height-20)+"px",n.className="introjs-arrow right-bottom"):n.className="introjs-arrow right",e.style.right=c.width+20+"px";break;case"floating":n.style.display="none",r=y(e),e.style.left="50%",e.style.top="50%",e.style.marginLeft="-"+r.width/2+"px",e.style.marginTop="-"+r.height/2+"px","undefined"!=typeof i&&null!=i&&(i.style.left="-"+(r.width/2+18)+"px",i.style.top="-"+(r.height/2+18)+"px");break;case"bottom-right-aligned":n.className="introjs-arrow top-right",e.style.right="0px",e.style.bottom="-"+(y(e).height+10)+"px";break;case"bottom-middle-aligned":s=y(t),r=y(e),n.className="introjs-arrow top-middle",e.style.left=s.width/2-r.width/2+"px",e.style.bottom="-"+(r.height+10)+"px";break;case"bottom-left-aligned":case"bottom":default:e.style.bottom="-"+(y(e).height+10)+"px",e.style.left=y(t).width/2-y(e).width/2+"px",n.className="introjs-arrow top"}}}function u(t,e,n){var i=this._options.positionPrecedence.slice(),o=m(),r=y(e).height+10,s=y(e).width+20,a=y(t),c="floating";return a.left+s>o.width||a.left+a.width/2-s<0?(l(i,"bottom"),l(i,"top")):(a.height+a.top+r>o.height&&l(i,"bottom"),a.top-r<0&&l(i,"top")),a.width+a.left+s>o.width&&l(i,"right"),a.left-s<0&&l(i,"left"),i.length>0&&(c=i[0]),n&&"auto"!=n&&i.indexOf(n)>-1&&(c=n),c}function l(t,e){t.indexOf(e)>-1&&t.splice(t.indexOf(e),1)}function h(t){if(t){if(!this._introItems[this._currentStep])return;var e=this._introItems[this._currentStep],n=y(e.element),i=10;"floating"==e.position&&(i=0),t.setAttribute("style","width: "+(n.width+i)+"px; height:"+(n.height+i)+"px; top:"+(n.top-5)+"px;left: "+(n.left-5)+"px;")}}function p(){var t=document.querySelector(".introjs-disableInteraction");null===t&&(t=document.createElement("div"),t.className="introjs-disableInteraction",this._targetElement.appendChild(t)),h.call(this,t)}function d(t){"undefined"!=typeof this._introChangeCallback&&this._introChangeCallback.call(this,t.element);var e=this,n=document.querySelector(".introjs-helperLayer"),i=document.querySelector(".introjs-tooltipReferenceLayer"),o="introjs-helperLayer";y(t.element);if("string"==typeof t.highlightClass&&(o+=" "+t.highlightClass),"string"==typeof this._options.highlightClass&&(o+=" "+this._options.highlightClass),null!=n){var u=i.querySelector(".introjs-helperNumberLayer"),l=i.querySelector(".introjs-tooltiptext"),d=i.querySelector(".introjs-arrow"),g=i.querySelector(".introjs-tooltip"),w=i.querySelector(".introjs-skipbutton"),E=i.querySelector(".introjs-prevbutton"),_=i.querySelector(".introjs-nextbutton");if(n.className=o,g.style.opacity=0,g.style.display="none",null!=u){var x=this._introItems[t.step-2>=0?t.step-2:0];(null!=x&&"forward"==this._direction&&"floating"==x.position||"backward"==this._direction&&"floating"==t.position)&&(u.style.opacity=0)}h.call(e,n),h.call(e,i);var M=document.querySelectorAll(".introjs-fixParent");if(M&&M.length>0)for(var T=M.length-1;T>=0;T--)M[T].className=M[T].className.replace(/introjs-fixParent/g,"").replace(/^\s+|\s+$/g,"");var S=document.querySelector(".introjs-showElement");S.className=S.className.replace(/introjs-[a-zA-Z]+/g,"").replace(/^\s+|\s+$/g,""),e._lastShowElementTimer&&clearTimeout(e._lastShowElementTimer),e._lastShowElementTimer=setTimeout(function(){null!=u&&(u.innerHTML=t.step),l.innerHTML=t.intro,g.style.display="block",c.call(e,t.element,g,d,u),i.querySelector(".introjs-bullets li > a.active").className="",i.querySelector('.introjs-bullets li > a[data-stepnumber="'+t.step+'"]').className="active",i.querySelector(".introjs-progress .introjs-progressbar").setAttribute("style","width:"+b.call(e)+"%;"),g.style.opacity=1,u&&(u.style.opacity=1),-1===_.tabIndex?w.focus():_.focus()},350)}else{var j=document.createElement("div"),k=document.createElement("div"),C=document.createElement("div"),P=document.createElement("div"),O=document.createElement("div"),L=document.createElement("div"),N=document.createElement("div"),A=document.createElement("div");j.className=o,k.className="introjs-tooltipReferenceLayer",h.call(e,j),h.call(e,k),this._targetElement.appendChild(j),this._targetElement.appendChild(k),C.className="introjs-arrow",O.className="introjs-tooltiptext",O.innerHTML=t.intro,L.className="introjs-bullets",this._options.showBullets===!1&&(L.style.display="none");for(var R=document.createElement("ul"),T=0,H=this._introItems.length;H>T;T++){var I=document.createElement("li"),z=document.createElement("a");z.onclick=function(){e.goToStep(this.getAttribute("data-stepnumber"))},T===t.step-1&&(z.className="active"),z.href="javascript:void(0);",z.innerHTML="&nbsp;",z.setAttribute("data-stepnumber",this._introItems[T].step),I.appendChild(z),R.appendChild(I)}L.appendChild(R),N.className="introjs-progress",this._options.showProgress===!1&&(N.style.display="none");var F=document.createElement("div");if(F.className="introjs-progressbar",F.setAttribute("style","width:"+b.call(this)+"%;"),N.appendChild(F),A.className="introjs-tooltipbuttons",this._options.showButtons===!1&&(A.style.display="none"),P.className="introjs-tooltip",P.appendChild(O),P.appendChild(L),P.appendChild(N),1==this._options.showStepNumbers){var D=document.createElement("span");D.className="introjs-helperNumberLayer",D.innerHTML=t.step,k.appendChild(D)}P.appendChild(C),k.appendChild(P);var _=document.createElement("a");_.onclick=function(){e._introItems.length-1!=e._currentStep&&r.call(e)},_.href="javascript:void(0);",_.innerHTML=this._options.nextLabel;var E=document.createElement("a");E.onclick=function(){0!=e._currentStep&&s.call(e)},E.href="javascript:void(0);",E.innerHTML=this._options.prevLabel;var w=document.createElement("a");w.className="introjs-button introjs-skipbutton",w.href="javascript:void(0);",w.innerHTML=this._options.skipLabel,w.onclick=function(){e._introItems.length-1==e._currentStep&&"function"==typeof e._introCompleteCallback&&e._introCompleteCallback.call(e),e._introItems.length-1!=e._currentStep&&"function"==typeof e._introExitCallback&&e._introExitCallback.call(e),a.call(e,e._targetElement)},A.appendChild(w),this._introItems.length>1&&(A.appendChild(E),A.appendChild(_)),P.appendChild(A),c.call(e,t.element,P,C,D)}this._options.disableInteraction===!0&&p.call(e),E.removeAttribute("tabIndex"),_.removeAttribute("tabIndex"),0==this._currentStep&&this._introItems.length>1?(E.className="introjs-button introjs-prevbutton introjs-disabled",E.tabIndex="-1",_.className="introjs-button introjs-nextbutton",w.innerHTML=this._options.skipLabel):this._introItems.length-1==this._currentStep||1==this._introItems.length?(w.innerHTML=this._options.doneLabel,E.className="introjs-button introjs-prevbutton",_.className="introjs-button introjs-nextbutton introjs-disabled",_.tabIndex="-1"):(E.className="introjs-button introjs-prevbutton",_.className="introjs-button introjs-nextbutton",w.innerHTML=this._options.skipLabel),_.focus(),t.element.className+=" introjs-showElement";var q=f(t.element,"position");"absolute"!==q&&"relative"!==q&&(t.element.className+=" introjs-relativePosition");for(var V=t.element.parentNode;null!=V&&"body"!==V.tagName.toLowerCase();){var B=f(V,"z-index"),G=parseFloat(f(V,"opacity")),U=f(V,"transform")||f(V,"-webkit-transform")||f(V,"-moz-transform")||f(V,"-ms-transform")||f(V,"-o-transform");(/[0-9]+/.test(B)||1>G||"none"!==U)&&(V.className+=" introjs-fixParent"),V=V.parentNode}if(!v(t.element)&&this._options.scrollToElement===!0){var Y=t.element.getBoundingClientRect(),W=m().height,X=Y.bottom-(Y.bottom-Y.top),Z=Y.bottom-W;0>X||t.element.clientHeight>W?window.scrollBy(0,X-30):window.scrollBy(0,Z+100)}"undefined"!=typeof this._introAfterChangeCallback&&this._introAfterChangeCallback.call(this,t.element)}function f(t,e){var n="";return t.currentStyle?n=t.currentStyle[e]:document.defaultView&&document.defaultView.getComputedStyle&&(n=document.defaultView.getComputedStyle(t,null).getPropertyValue(e)),n&&n.toLowerCase?n.toLowerCase():n}function m(){if(void 0!=window.innerWidth)return{width:window.innerWidth,height:window.innerHeight};var t=document.documentElement;
return{width:t.clientWidth,height:t.clientHeight}}function v(t){var e=t.getBoundingClientRect();return e.top>=0&&e.left>=0&&e.bottom+80<=window.innerHeight&&e.right<=window.innerWidth}function g(t){var e=document.createElement("div"),n="",i=this;if(e.className="introjs-overlay","body"===t.tagName.toLowerCase())n+="top: 0;bottom: 0; left: 0;right: 0;position: fixed;",e.setAttribute("style",n);else{var o=y(t);o&&(n+="width: "+o.width+"px; height:"+o.height+"px; top:"+o.top+"px;left: "+o.left+"px;",e.setAttribute("style",n))}return t.appendChild(e),e.onclick=function(){1==i._options.exitOnOverlayClick&&(a.call(i,t),void 0!=i._introExitCallback&&i._introExitCallback.call(i))},setTimeout(function(){n+="opacity: "+i._options.overlayOpacity.toString()+";",e.setAttribute("style",n)},10),!0}function y(t){var e={};e.width=t.offsetWidth,e.height=t.offsetHeight;for(var n=0,i=0;t&&!isNaN(t.offsetLeft)&&!isNaN(t.offsetTop);)n+=t.offsetLeft,i+=t.offsetTop,t=t.offsetParent;return e.top=i,e.left=n,e}function b(){var t=parseInt(this._currentStep+1,10);return t/this._introItems.length*100}function w(t,e){var n={};for(var i in t)n[i]=t[i];for(var i in e)n[i]=e[i];return n}var E="1.0.0",_=function(t){if("object"==typeof t)return new e(t);if("string"==typeof t){var n=document.querySelector(t);if(n)return new e(n);throw new Error("There is no element with given selector.")}return new e(document.body)};return _.version=E,_.fn=e.prototype={clone:function(){return new e(this)},setOption:function(t,e){return this._options[t]=e,this},setOptions:function(t){return this._options=w(this._options,t),this},start:function(){return n.call(this,this._targetElement),this},goToStep:function(t){return o.call(this,t),this},nextStep:function(){return r.call(this),this},previousStep:function(){return s.call(this),this},exit:function(){return a.call(this,this._targetElement),this},refresh:function(){return h.call(this,document.querySelector(".introjs-helperLayer")),h.call(this,document.querySelector(".introjs-tooltipReferenceLayer")),this},onbeforechange:function(t){if("function"!=typeof t)throw new Error("Provided callback for onbeforechange was not a function");return this._introBeforeChangeCallback=t,this},onchange:function(t){if("function"!=typeof t)throw new Error("Provided callback for onchange was not a function.");return this._introChangeCallback=t,this},onafterchange:function(t){if("function"!=typeof t)throw new Error("Provided callback for onafterchange was not a function");return this._introAfterChangeCallback=t,this},oncomplete:function(t){if("function"!=typeof t)throw new Error("Provided callback for oncomplete was not a function.");return this._introCompleteCallback=t,this},onexit:function(t){if("function"!=typeof t)throw new Error("Provided callback for onexit was not a function.");return this._introExitCallback=t,this}},t.introJs=_,_}),function(t,e,n){function i(n,r){if(!e[n]){if(!t[n]){var s="function"==typeof require&&require;if(!r&&s)return s(n,!0);if(o)return o(n,!0);throw new Error("Cannot find module '"+n+"'")}var a=e[n]={exports:{}};t[n][0].call(a.exports,function(e){var o=t[n][1][e];return i(o?o:e)},a,a.exports)}return e[n].exports}for(var o="function"==typeof require&&require,r=0;r<n.length;r++)i(n[r]);return i}({1:[function(t,e,n){var i=(t("./pointable"),t("gl-matrix")),o=i.vec3,r=i.mat3,s=i.mat4,a=(t("underscore"),e.exports=function(t,e){this.finger=t,this._center=null,this._matrix=null,this.type=e.type,this.prevJoint=e.prevJoint,this.nextJoint=e.nextJoint,this.width=e.width;var n=new Array(3);o.sub(n,e.nextJoint,e.prevJoint),this.length=o.length(n),this.basis=e.basis});a.prototype.left=function(){return this._left?this._left:(this._left=r.determinant(this.basis[0].concat(this.basis[1]).concat(this.basis[2]))<0,this._left)},a.prototype.matrix=function(){if(this._matrix)return this._matrix;var t=this.basis,e=this._matrix=s.create();return e[0]=t[0][0],e[1]=t[0][1],e[2]=t[0][2],e[4]=t[1][0],e[5]=t[1][1],e[6]=t[1][2],e[8]=t[2][0],e[9]=t[2][1],e[10]=t[2][2],e[3]=this.center()[0],e[7]=this.center()[1],e[11]=this.center()[2],this.left()&&(e[0]*=-1,e[1]*=-1,e[2]*=-1),this._matrix},a.prototype.lerp=function(t,e){o.lerp(t,this.prevJoint,this.nextJoint,e)},a.prototype.center=function(){if(this._center)return this._center;var t=o.create();return this.lerp(t,.5),this._center=t,t},a.prototype.direction=function(){return[-1*this.basis[2][0],-1*this.basis[2][1],-1*this.basis[2][2]]}},{"./pointable":14,"gl-matrix":23,underscore:24}],2:[function(t,e,n){var i=e.exports=function(t){this.pos=0,this._buf=[],this.size=t};i.prototype.get=function(t){return void 0==t&&(t=0),t>=this.size?void 0:t>=this._buf.length?void 0:this._buf[(this.pos-t-1)%this.size]},i.prototype.push=function(t){return this._buf[this.pos%this.size]=t,this.pos++}},{}],3:[function(t,e,n){var i=t("../protocol").chooseProtocol,o=t("events").EventEmitter,r=t("underscore"),s=e.exports=function(t){this.opts=r.defaults(t||{},{host:"127.0.0.1",enableGestures:!1,scheme:this.getScheme(),port:this.getPort(),background:!1,optimizeHMD:!1,requestProtocolVersion:s.defaultProtocolVersion}),this.host=this.opts.host,this.port=this.opts.port,this.scheme=this.opts.scheme,this.protocolVersionVerified=!1,this.background=null,this.optimizeHMD=null,this.on("ready",function(){this.enableGestures(this.opts.enableGestures),this.setBackground(this.opts.background),this.setOptimizeHMD(this.opts.optimizeHMD),this.opts.optimizeHMD?console.log("Optimized for head mounted display usage."):console.log("Optimized for desktop usage.")})};s.defaultProtocolVersion=6,s.prototype.getUrl=function(){return this.scheme+"//"+this.host+":"+this.port+"/v"+this.opts.requestProtocolVersion+".json"},s.prototype.getScheme=function(){return"ws:"},s.prototype.getPort=function(){return 6437},s.prototype.setBackground=function(t){this.opts.background=t,this.protocol&&this.protocol.sendBackground&&this.background!==this.opts.background&&(this.background=this.opts.background,this.protocol.sendBackground(this,this.opts.background))},s.prototype.setOptimizeHMD=function(t){this.opts.optimizeHMD=t,this.protocol&&this.protocol.sendOptimizeHMD&&this.optimizeHMD!==this.opts.optimizeHMD&&(this.optimizeHMD=this.opts.optimizeHMD,this.protocol.sendOptimizeHMD(this,this.opts.optimizeHMD))},s.prototype.handleOpen=function(){this.connected||(this.connected=!0,this.emit("connect"))},s.prototype.enableGestures=function(t){this.gesturesEnabled=t?!0:!1,this.send(this.protocol.encode({enableGestures:this.gesturesEnabled}))},s.prototype.handleClose=function(t,e){this.connected&&(this.disconnect(),1001===t&&this.opts.requestProtocolVersion>1&&(this.protocolVersionVerified?this.protocolVersionVerified=!1:this.opts.requestProtocolVersion--),this.startReconnection())},s.prototype.startReconnection=function(){var t=this;this.reconnectionTimer||(this.reconnectionTimer=setInterval(function(){t.reconnect()},500))},s.prototype.stopReconnection=function(){this.reconnectionTimer=clearInterval(this.reconnectionTimer)},s.prototype.disconnect=function(t){return t||this.stopReconnection(),this.socket?(this.socket.close(),delete this.socket,delete this.protocol,delete this.background,delete this.optimizeHMD,delete this.focusedState,this.connected&&(this.connected=!1,this.emit("disconnect")),!0):void 0},s.prototype.reconnect=function(){this.connected?this.stopReconnection():(this.disconnect(!0),this.connect())},s.prototype.handleData=function(t){var e,n=JSON.parse(t);void 0===this.protocol?(e=this.protocol=i(n),this.protocolVersionVerified=!0,this.emit("ready")):e=this.protocol(n),this.emit(e.type,e)},s.prototype.connect=function(){return this.socket?void 0:(this.socket=this.setupSocket(),!0)},s.prototype.send=function(t){this.socket.send(t)},s.prototype.reportFocus=function(t){this.connected&&this.focusedState!==t&&(this.focusedState=t,this.emit(this.focusedState?"focus":"blur"),this.protocol&&this.protocol.sendFocused&&this.protocol.sendFocused(this,this.focusedState))},r.extend(s.prototype,o.prototype)},{"../protocol":15,events:21,underscore:24}],4:[function(t,e,n){var i=e.exports=t("./base"),o=t("underscore"),r=e.exports=function(t){i.call(this,t);var e=this;this.on("ready",function(){e.startFocusLoop()}),this.on("disconnect",function(){e.stopFocusLoop()})};o.extend(r.prototype,i.prototype),r.__proto__=i,r.prototype.useSecure=function(){return"https:"===location.protocol},r.prototype.getScheme=function(){return this.useSecure()?"wss:":"ws:"},r.prototype.getPort=function(){return this.useSecure()?6436:6437},r.prototype.setupSocket=function(){var t=this,e=new WebSocket(this.getUrl());return e.onopen=function(){t.handleOpen()},e.onclose=function(e){t.handleClose(e.code,e.reason)},e.onmessage=function(e){t.handleData(e.data)},e.onerror=function(e){t.useSecure()&&"wss:"===t.scheme&&(t.scheme="ws:",t.port=6437,t.disconnect(),t.connect())},e},r.prototype.startFocusLoop=function(){if(!this.focusDetectorTimer){var t=this,e=null;e="undefined"!=typeof document.hidden?"hidden":"undefined"!=typeof document.mozHidden?"mozHidden":"undefined"!=typeof document.msHidden?"msHidden":"undefined"!=typeof document.webkitHidden?"webkitHidden":void 0,void 0===t.windowVisible&&(t.windowVisible=void 0===e?!0:document[e]===!1);var n=window.addEventListener("focus",function(e){t.windowVisible=!0,o()}),i=window.addEventListener("blur",function(e){t.windowVisible=!1,o()});this.on("disconnect",function(){window.removeEventListener("focus",n),window.removeEventListener("blur",i)});var o=function(){var n=void 0===e?!0:document[e]===!1;t.reportFocus(n&&t.windowVisible)};o(),this.focusDetectorTimer=setInterval(o,100)}},r.prototype.stopFocusLoop=function(){this.focusDetectorTimer&&(clearTimeout(this.focusDetectorTimer),delete this.focusDetectorTimer)}},{"./base":3,underscore:24}],5:[function(t,e,n){var i=t("__browserify_process"),o=t("./frame"),r=t("./hand"),s=t("./pointable"),a=t("./finger"),c=t("./circular_buffer"),u=t("./pipeline"),l=t("events").EventEmitter,h=t("./gesture").gestureListener,p=t("./dialog"),d=t("underscore"),f=e.exports=function(e){var n="undefined"!=typeof i&&i.versions&&i.versions.node,r=this;e=d.defaults(e||{},{inNode:n}),this.inNode=e.inNode,e=d.defaults(e||{},{frameEventName:this.useAnimationLoop()?"animationFrame":"deviceFrame",suppressAnimationLoop:!this.useAnimationLoop(),loopWhileDisconnected:!0,useAllPlugins:!1,checkVersion:!0}),this.animationFrameRequested=!1,this.onAnimationFrame=function(t){r.lastConnectionFrame.valid&&r.emit("animationFrame",r.lastConnectionFrame),r.emit("frameEnd",t),r.loopWhileDisconnected&&(r.connection.focusedState!==!1||r.connection.opts.background)?window.requestAnimationFrame(r.onAnimationFrame):r.animationFrameRequested=!1},this.suppressAnimationLoop=e.suppressAnimationLoop,this.loopWhileDisconnected=e.loopWhileDisconnected,this.frameEventName=e.frameEventName,this.useAllPlugins=e.useAllPlugins,this.history=new c(200),this.lastFrame=o.Invalid,this.lastValidFrame=o.Invalid,this.lastConnectionFrame=o.Invalid,this.accumulatedGestures=[],this.checkVersion=e.checkVersion,void 0===e.connectionType?this.connectionType=t(this.inBrowser()?"./connection/browser":"./connection/node"):this.connectionType=e.connectionType,this.connection=new this.connectionType(e),this.streamingCount=0,this.devices={},this.plugins={},this._pluginPipelineSteps={},this._pluginExtendedMethods={},e.useAllPlugins&&this.useRegisteredPlugins(),this.setupFrameEvents(e),this.setupConnectionEvents(),this.startAnimationLoop()};f.prototype.gesture=function(t,e){var n=h(this,t);return void 0!==e&&n.stop(e),n},f.prototype.setBackground=function(t){return this.connection.setBackground(t),this},f.prototype.setOptimizeHMD=function(t){return this.connection.setOptimizeHMD(t),this},f.prototype.inBrowser=function(){return!this.inNode},f.prototype.useAnimationLoop=function(){return this.inBrowser()&&!this.inBackgroundPage()},f.prototype.inBackgroundPage=function(){return"undefined"!=typeof chrome&&chrome.extension&&chrome.extension.getBackgroundPage&&chrome.extension.getBackgroundPage()===window},f.prototype.connect=function(){return this.connection.connect(),this},f.prototype.streaming=function(){return this.streamingCount>0},f.prototype.connected=function(){return!!this.connection.connected},f.prototype.startAnimationLoop=function(){this.suppressAnimationLoop||this.animationFrameRequested||(this.animationFrameRequested=!0,window.requestAnimationFrame(this.onAnimationFrame))},f.prototype.disconnect=function(){return this.connection.disconnect(),this},f.prototype.frame=function(t){return this.history.get(t)||o.Invalid},f.prototype.loop=function(t){return t&&("function"==typeof t?this.on(this.frameEventName,t):this.setupFrameEvents(t)),this.connect()},f.prototype.addStep=function(t){this.pipeline||(this.pipeline=new u(this)),this.pipeline.addStep(t)},f.prototype.processFrame=function(t){t.gestures&&(this.accumulatedGestures=this.accumulatedGestures.concat(t.gestures)),this.lastConnectionFrame=t,this.startAnimationLoop(),this.emit("deviceFrame",t)},f.prototype.processFinishedFrame=function(t){if(this.lastFrame=t,t.valid&&(this.lastValidFrame=t),t.controller=this,t.historyIdx=this.history.push(t),t.gestures){t.gestures=this.accumulatedGestures,this.accumulatedGestures=[];for(var e=0;e!=t.gestures.length;e++)this.emit("gesture",t.gestures[e],t)}this.pipeline&&(t=this.pipeline.run(t),t||(t=o.Invalid)),this.emit("frame",t),this.emitHandEvents(t)},f.prototype.emitHandEvents=function(t){for(var e=0;e<t.hands.length;e++)this.emit("hand",t.hands[e])},f.prototype.setupFrameEvents=function(t){t.frame&&this.on("frame",t.frame),t.hand&&this.on("hand",t.hand)},f.prototype.setupConnectionEvents=function(){var t=this;this.connection.on("frame",function(e){t.processFrame(e)}),this.on(this.frameEventName,function(e){t.processFinishedFrame(e)});var e=function(){if(t.connection.opts.requestProtocolVersion<5&&0==t.streamingCount){t.streamingCount=1;var n={attached:!0,streaming:!0,type:"unknown",id:"Lx00000000000"};t.devices[n.id]=n,t.emit("deviceAttached",n),t.emit("deviceStreaming",n),t.emit("streamingStarted",n),t.connection.removeListener("frame",e)}},n=function(){if(t.streamingCount>0){for(var e in t.devices)t.emit("deviceStopped",t.devices[e]),t.emit("deviceRemoved",t.devices[e]);t.emit("streamingStopped",t.devices[e]),t.streamingCount=0;for(var e in t.devices)delete t.devices[e]}};this.connection.on("focus",function(){t.loopWhileDisconnected&&t.startAnimationLoop(),t.emit("focus")}),this.connection.on("blur",function(){t.emit("blur")}),this.connection.on("protocol",function(e){e.on("beforeFrameCreated",function(e){t.emit("beforeFrameCreated",e)}),e.on("afterFrameCreated",function(e,n){t.emit("afterFrameCreated",e,n)}),t.emit("protocol",e)}),this.connection.on("ready",function(){t.checkVersion&&!t.inNode&&t.checkOutOfDate(),t.emit("ready")}),this.connection.on("connect",function(){t.emit("connect"),t.connection.removeListener("frame",e),t.connection.on("frame",e)}),this.connection.on("disconnect",function(){t.emit("disconnect"),n()}),this.connection.on("deviceConnect",function(i){i.state?(t.emit("deviceConnected"),t.connection.removeListener("frame",e),t.connection.on("frame",e)):(t.emit("deviceDisconnected"),n())}),this.connection.on("deviceEvent",function(e){var n=e.state,i=t.devices[n.id],o={};for(var r in n)i&&i.hasOwnProperty(r)&&i[r]==n[r]||(o[r]=!0);t.devices[n.id]=n,o.attached&&t.emit(n.attached?"deviceAttached":"deviceRemoved",n),o.streaming&&(n.streaming?(t.streamingCount++,t.emit("deviceStreaming",n),1==t.streamingCount&&t.emit("streamingStarted",n),o.attached||t.emit("deviceConnected")):o.attached&&n.attached||(t.streamingCount--,t.emit("deviceStopped",n),0==t.streamingCount&&t.emit("streamingStopped",n),t.emit("deviceDisconnected")))}),this.on("newListener",function(t,e){("deviceConnected"==t||"deviceDisconnected"==t)&&console.warn(t+" events are depricated.  Consider using 'streamingStarted/streamingStopped' or 'deviceStreaming/deviceStopped' instead")})},f.prototype.checkOutOfDate=function(){console.assert(this.connection&&this.connection.protocol);var t=this.connection.protocol.serviceVersion,e=this.connection.protocol.version,n=this.connectionType.defaultProtocolVersion;return n>e?(console.warn("Your Protocol Version is v"+e+", this app was designed for v"+n),p.warnOutOfDate({sV:t,pV:e}),!0):!1},f._pluginFactories={},f.plugin=function(t,e){return this._pluginFactories[t]&&console.warn('Plugin "'+t+'" already registered'),this._pluginFactories[t]=e},f.plugins=function(){return d.keys(this._pluginFactories)};var m=function(t,e,n){-1!=["beforeFrameCreated","afterFrameCreated"].indexOf(e)?this.on(e,n):(this.pipeline||(this.pipeline=new u(this)),this._pluginPipelineSteps[t]||(this._pluginPipelineSteps[t]=[]),this._pluginPipelineSteps[t].push(this.pipeline.addWrappedStep(e,n)))},v=function(t,e,n){var i;switch(this._pluginExtendedMethods[t]||(this._pluginExtendedMethods[t]=[]),e){case"frame":i=o;break;case"hand":i=r;break;case"pointable":i=s,d.extend(a.prototype,n),d.extend(a.Invalid,n);break;case"finger":i=a;break;default:throw t+' specifies invalid object type "'+e+'" for prototypical extension'}d.extend(i.prototype,n),d.extend(i.Invalid,n),this._pluginExtendedMethods[t].push([i,n])};f.prototype.use=function(t,e){var n,i,o,r;if(i="function"==typeof t?t:f._pluginFactories[t],!i)throw"Leap Plugin "+t+" not found.";if(e||(e={}),this.plugins[t])return d.extend(this.plugins[t],e),this;this.plugins[t]=e,r=i.call(this,e);for(o in r)n=r[o],"function"==typeof n?m.call(this,t,o,n):v.call(this,t,o,n);return this},f.prototype.stopUsing=function(t){var e,n,i=this._pluginPipelineSteps[t],o=this._pluginExtendedMethods[t],r=0;if(this.plugins[t]){if(i)for(r=0;r<i.length;r++)this.pipeline.removeStep(i[r]);if(o)for(r=0;r<o.length;r++){e=o[r][0],n=o[r][1];for(var s in n)delete e.prototype[s],delete e.Invalid[s]}return delete this.plugins[t],this}},f.prototype.useRegisteredPlugins=function(){for(var t in f._pluginFactories)this.use(t)},d.extend(f.prototype,l.prototype)},{"./circular_buffer":2,"./connection/browser":4,"./connection/node":20,"./dialog":6,"./finger":7,"./frame":8,"./gesture":9,"./hand":10,"./pipeline":13,"./pointable":14,__browserify_process:22,events:21,underscore:24}],6:[function(t,e,n){var i=t("__browserify_process"),o=e.exports=function(t,e){this.options=e||{},this.message=t,this.createElement()};o.prototype.createElement=function(){this.element=document.createElement("div"),this.element.className="leapjs-dialog",this.element.style.position="fixed",this.element.style.top="8px",this.element.style.left=0,this.element.style.right=0,this.element.style.textAlign="center",this.element.style.zIndex=1e3;var t=document.createElement("div");this.element.appendChild(t),t.style.className="leapjs-dialog",t.style.display="inline-block",t.style.margin="auto",t.style.padding="8px",t.style.color="#222",t.style.background="#eee",t.style.borderRadius="4px",t.style.border="1px solid #999",t.style.textAlign="left",t.style.cursor="pointer",t.style.whiteSpace="nowrap",t.style.transition="box-shadow 1s linear",t.innerHTML=this.message,this.options.onclick&&t.addEventListener("click",this.options.onclick),this.options.onmouseover&&t.addEventListener("mouseover",this.options.onmouseover),this.options.onmouseout&&t.addEventListener("mouseout",this.options.onmouseout),this.options.onmousemove&&t.addEventListener("mousemove",this.options.onmousemove)},o.prototype.show=function(){return document.body.appendChild(this.element),this},o.prototype.hide=function(){return document.body.removeChild(this.element),this},o.warnOutOfDate=function(t){t||(t={});var e="http://developer.leapmotion.com?";t.returnTo=window.location.href;for(var n in t)e+=n+"="+encodeURIComponent(t[n])+"&";var i,r=function(t){if("leapjs-decline-upgrade"!=t.target.id){var n=window.open(e,"_blank","height=800,width=1000,location=1,menubar=1,resizable=1,status=1,toolbar=1,scrollbars=1");window.focus&&n.focus()}return i.hide(),!0},s="This site requires Leap Motion Tracking V2.<button id='leapjs-accept-upgrade'  style='color: #444; transition: box-shadow 100ms linear; cursor: pointer; vertical-align: baseline; margin-left: 16px;'>Upgrade</button><button id='leapjs-decline-upgrade' style='color: #444; transition: box-shadow 100ms linear; cursor: pointer; vertical-align: baseline; margin-left: 8px; '>Not Now</button>";return i=new o(s,{onclick:r,onmousemove:function(t){t.target==document.getElementById("leapjs-decline-upgrade")?(document.getElementById("leapjs-decline-upgrade").style.color="#000",document.getElementById("leapjs-decline-upgrade").style.boxShadow="0px 0px 2px #5daa00",document.getElementById("leapjs-accept-upgrade").style.color="#444",document.getElementById("leapjs-accept-upgrade").style.boxShadow="none"):(document.getElementById("leapjs-accept-upgrade").style.color="#000",document.getElementById("leapjs-accept-upgrade").style.boxShadow="0px 0px 2px #5daa00",document.getElementById("leapjs-decline-upgrade").style.color="#444",document.getElementById("leapjs-decline-upgrade").style.boxShadow="none")},onmouseout:function(){document.getElementById("leapjs-decline-upgrade").style.color="#444",document.getElementById("leapjs-decline-upgrade").style.boxShadow="none",document.getElementById("leapjs-accept-upgrade").style.color="#444",document.getElementById("leapjs-accept-upgrade").style.boxShadow="none"}}),i.show()},o.hasWarnedBones=!1,o.warnBones=function(){this.hasWarnedBones||(this.hasWarnedBones=!0,console.warn("Your Leap Service is out of date"),"undefined"!=typeof i&&i.versions&&i.versions.node||this.warnOutOfDate({reason:"bones"}))}},{__browserify_process:22}],7:[function(t,e,n){var i=t("./pointable"),o=t("./bone"),r=t("./dialog"),s=t("underscore"),a=e.exports=function(t){i.call(this,t),this.dipPosition=t.dipPosition,this.pipPosition=t.pipPosition,this.mcpPosition=t.mcpPosition,this.carpPosition=t.carpPosition,this.extended=t.extended,this.type=t.type,this.finger=!0,this.positions=[this.carpPosition,this.mcpPosition,this.pipPosition,this.dipPosition,this.tipPosition],t.bases?this.addBones(t):r.warnBones()};s.extend(a.prototype,i.prototype),a.prototype.addBones=function(t){this.metacarpal=new o(this,{type:0,width:this.width,prevJoint:this.carpPosition,nextJoint:this.mcpPosition,basis:t.bases[0]}),this.proximal=new o(this,{type:1,width:this.width,prevJoint:this.mcpPosition,nextJoint:this.pipPosition,basis:t.bases[1]}),this.medial=new o(this,{type:2,width:this.width,prevJoint:this.pipPosition,nextJoint:this.dipPosition,basis:t.bases[2]}),this.distal=new o(this,{type:3,width:this.width,prevJoint:this.dipPosition,nextJoint:t.btipPosition,basis:t.bases[3]}),this.bones=[this.metacarpal,this.proximal,this.medial,this.distal]},a.prototype.toString=function(){return"Finger [ id:"+this.id+" "+this.length+"mmx | width:"+this.width+"mm | direction:"+this.direction+" ]"},a.Invalid={valid:!1}},{"./bone":1,"./dialog":6,"./pointable":14,underscore:24}],8:[function(t,e,n){var i=t("./hand"),o=t("./pointable"),r=t("./gesture").createGesture,s=t("gl-matrix"),a=s.mat3,c=s.vec3,u=t("./interaction_box"),l=t("./finger"),h=t("underscore"),p=e.exports=function(t){if(this.valid=!0,this.id=t.id,this.timestamp=t.timestamp,this.hands=[],this.handsMap={},this.pointables=[],this.tools=[],this.fingers=[],t.interactionBox&&(this.interactionBox=new u(t.interactionBox)),this.gestures=[],this.pointablesMap={},this._translation=t.t,this._rotation=h.flatten(t.r),this._scaleFactor=t.s,this.data=t,this.type="frame",this.currentFrameRate=t.currentFrameRate,t.gestures)for(var e=0,n=t.gestures.length;e!=n;e++)this.gestures.push(r(t.gestures[e]));this.postprocessData(t)};p.prototype.postprocessData=function(t){t||(t=this.data);for(var e=0,n=t.hands.length;e!=n;e++){var r=new i(t.hands[e]);r.frame=this,this.hands.push(r),this.handsMap[r.id]=r}t.pointables=h.sortBy(t.pointables,function(t){return t.id});for(var s=0,a=t.pointables.length;s!=a;s++){var c=t.pointables[s],u=c.dipPosition?new l(c):new o(c);u.frame=this,this.addPointable(u)}},p.prototype.addPointable=function(t){if(this.pointables.push(t),this.pointablesMap[t.id]=t,(t.tool?this.tools:this.fingers).push(t),void 0!==t.handId&&this.handsMap.hasOwnProperty(t.handId)){var e=this.handsMap[t.handId];switch(e.pointables.push(t),(t.tool?e.tools:e.fingers).push(t),t.type){case 0:e.thumb=t;break;case 1:e.indexFinger=t;break;case 2:e.middleFinger=t;break;case 3:e.ringFinger=t;break;case 4:e.pinky=t}}},p.prototype.tool=function(t){var e=this.pointable(t);return e.tool?e:o.Invalid},p.prototype.pointable=function(t){return this.pointablesMap[t]||o.Invalid},p.prototype.finger=function(t){var e=this.pointable(t);return e.tool?o.Invalid:e},p.prototype.hand=function(t){return this.handsMap[t]||i.Invalid},p.prototype.rotationAngle=function(t,e){if(!this.valid||!t.valid)return 0;var n=this.rotationMatrix(t),i=.5*(n[0]+n[4]+n[8]-1),o=Math.acos(i);if(o=isNaN(o)?0:o,void 0!==e){var r=this.rotationAxis(t);o*=c.dot(r,c.normalize(c.create(),e))}return o},p.prototype.rotationAxis=function(t){return this.valid&&t.valid?c.normalize(c.create(),[this._rotation[7]-t._rotation[5],this._rotation[2]-t._rotation[6],this._rotation[3]-t._rotation[1]]):c.create()},p.prototype.rotationMatrix=function(t){if(!this.valid||!t.valid)return a.create();var e=a.transpose(a.create(),this._rotation);return a.multiply(a.create(),t._rotation,e)},p.prototype.scaleFactor=function(t){return this.valid&&t.valid?Math.exp(this._scaleFactor-t._scaleFactor):1},p.prototype.translation=function(t){return this.valid&&t.valid?c.subtract(c.create(),this._translation,t._translation):c.create()},p.prototype.toString=function(){var t="Frame [ id:"+this.id+" | timestamp:"+this.timestamp+" | Hand count:("+this.hands.length+") | Pointable count:("+this.pointables.length+")";return this.gestures&&(t+=" | Gesture count:("+this.gestures.length+")"),t+=" ]"},p.prototype.dump=function(){var t="";t+="Frame Info:<br/>",t+=this.toString(),t+="<br/><br/>Hands:<br/>";for(var e=0,n=this.hands.length;e!=n;e++)t+="  "+this.hands[e].toString()+"<br/>";t+="<br/><br/>Pointables:<br/>";for(var i=0,o=this.pointables.length;i!=o;i++)t+="  "+this.pointables[i].toString()+"<br/>";if(this.gestures){t+="<br/><br/>Gestures:<br/>";for(var r=0,s=this.gestures.length;r!=s;r++)t+="  "+this.gestures[r].toString()+"<br/>"}return t+="<br/><br/>Raw JSON:<br/>",t+=JSON.stringify(this.data)},p.Invalid={valid:!1,hands:[],fingers:[],tools:[],gestures:[],pointables:[],pointable:function(){return o.Invalid},finger:function(){return o.Invalid},hand:function(){return i.Invalid},toString:function(){return"invalid frame"},dump:function(){return this.toString()},rotationAngle:function(){return 0},rotationMatrix:function(){return a.create()},rotationAxis:function(){return c.create()},scaleFactor:function(){return 1},translation:function(){return c.create()}}},{"./finger":7,"./gesture":9,"./hand":10,"./interaction_box":12,"./pointable":14,"gl-matrix":23,underscore:24}],9:[function(t,e,n){var i=t("gl-matrix"),o=i.vec3,r=t("events").EventEmitter,s=t("underscore"),a=(n.createGesture=function(t){var e;switch(t.type){case"circle":e=new c(t);break;case"swipe":e=new u(t);break;case"screenTap":e=new l(t);break;case"keyTap":e=new h(t);break;default:throw"unknown gesture type"}return e.id=t.id,e.handIds=t.handIds.slice(),e.pointableIds=t.pointableIds.slice(),e.duration=t.duration,e.state=t.state,e.type=t.type,e},n.gestureListener=function(t,e){var n={},i={};t.on("gesture",function(t,o){if(t.type==e){if(("start"==t.state||"stop"==t.state)&&void 0===i[t.id]){var r=new a(t,o);i[t.id]=r,s.each(n,function(t,e){r.on(e,t)})}i[t.id].update(t,o),"stop"==t.state&&delete i[t.id]}});var o={start:function(t){return n.start=t,o},stop:function(t){return n.stop=t,o},complete:function(t){return n.stop=t,o},update:function(t){return n.update=t,o}};return o},n.Gesture=function(t,e){this.gestures=[t],this.frames=[e]});a.prototype.update=function(t,e){this.lastGesture=t,this.lastFrame=e,this.gestures.push(t),this.frames.push(e),this.emit(t.state,this)},a.prototype.translation=function(){return o.subtract(o.create(),this.lastGesture.startPosition,this.lastGesture.position)},s.extend(a.prototype,r.prototype);var c=function(t){this.center=t.center,this.normal=t.normal,this.progress=t.progress,this.radius=t.radius};c.prototype.toString=function(){return"CircleGesture ["+JSON.stringify(this)+"]"};var u=function(t){this.startPosition=t.startPosition,this.position=t.position,this.direction=t.direction,this.speed=t.speed};u.prototype.toString=function(){return"SwipeGesture ["+JSON.stringify(this)+"]"};var l=function(t){this.position=t.position,this.direction=t.direction,this.progress=t.progress};l.prototype.toString=function(){return"ScreenTapGesture ["+JSON.stringify(this)+"]"};var h=function(t){this.position=t.position,this.direction=t.direction,this.progress=t.progress};h.prototype.toString=function(){return"KeyTapGesture ["+JSON.stringify(this)+"]"}},{events:21,"gl-matrix":23,underscore:24}],10:[function(t,e,n){var i=t("./pointable"),o=t("./bone"),r=t("gl-matrix"),s=r.mat3,a=r.vec3,c=t("underscore"),u=e.exports=function(t){this.id=t.id,this.palmPosition=t.palmPosition,this.direction=t.direction,this.palmVelocity=t.palmVelocity,this.palmNormal=t.palmNormal,this.sphereCenter=t.sphereCenter,this.sphereRadius=t.sphereRadius,this.valid=!0,this.pointables=[],this.fingers=[],t.armBasis?this.arm=new o(this,{type:4,width:t.armWidth,prevJoint:t.elbow,nextJoint:t.wrist,basis:t.armBasis}):this.arm=null,this.tools=[],this._translation=t.t,this._rotation=c.flatten(t.r),this._scaleFactor=t.s,this.timeVisible=t.timeVisible,this.stabilizedPalmPosition=t.stabilizedPalmPosition,this.type=t.type,this.grabStrength=t.grabStrength,this.pinchStrength=t.pinchStrength,this.confidence=t.confidence};u.prototype.finger=function(t){var e=this.frame.finger(t);return e&&e.handId==this.id?e:i.Invalid},u.prototype.rotationAngle=function(t,e){if(!this.valid||!t.valid)return 0;var n=t.hand(this.id);if(!n.valid)return 0;var i=this.rotationMatrix(t),o=.5*(i[0]+i[4]+i[8]-1),r=Math.acos(o);if(r=isNaN(r)?0:r,void 0!==e){var s=this.rotationAxis(t);r*=a.dot(s,a.normalize(a.create(),e))}return r},u.prototype.rotationAxis=function(t){if(!this.valid||!t.valid)return a.create();var e=t.hand(this.id);return e.valid?a.normalize(a.create(),[this._rotation[7]-e._rotation[5],this._rotation[2]-e._rotation[6],this._rotation[3]-e._rotation[1]]):a.create()},u.prototype.rotationMatrix=function(t){if(!this.valid||!t.valid)return s.create();var e=t.hand(this.id);if(!e.valid)return s.create();var n=s.transpose(s.create(),this._rotation),i=s.multiply(s.create(),e._rotation,n);return i},u.prototype.scaleFactor=function(t){if(!this.valid||!t.valid)return 1;var e=t.hand(this.id);return e.valid?Math.exp(this._scaleFactor-e._scaleFactor):1},u.prototype.translation=function(t){if(!this.valid||!t.valid)return a.create();var e=t.hand(this.id);return e.valid?[this._translation[0]-e._translation[0],this._translation[1]-e._translation[1],this._translation[2]-e._translation[2]]:a.create()},u.prototype.toString=function(){return"Hand ("+this.type+") [ id: "+this.id+" | palm velocity:"+this.palmVelocity+" | sphere center:"+this.sphereCenter+" ] "},u.prototype.pitch=function(){return Math.atan2(this.direction[1],-this.direction[2])},u.prototype.yaw=function(){return Math.atan2(this.direction[0],-this.direction[2])},u.prototype.roll=function(){return Math.atan2(this.palmNormal[0],-this.palmNormal[1])},u.Invalid={valid:!1,fingers:[],tools:[],pointables:[],left:!1,pointable:function(){return i.Invalid},finger:function(){return i.Invalid},toString:function(){return"invalid frame"},dump:function(){return this.toString()},rotationAngle:function(){return 0},rotationMatrix:function(){return s.create()},rotationAxis:function(){return a.create()},scaleFactor:function(){return 1},translation:function(){return a.create()}}},{"./bone":1,"./pointable":14,"gl-matrix":23,underscore:24}],11:[function(t,e,n){e.exports={Controller:t("./controller"),Frame:t("./frame"),
Gesture:t("./gesture"),Hand:t("./hand"),Pointable:t("./pointable"),Finger:t("./finger"),InteractionBox:t("./interaction_box"),CircularBuffer:t("./circular_buffer"),UI:t("./ui"),JSONProtocol:t("./protocol").JSONProtocol,glMatrix:t("gl-matrix"),mat3:t("gl-matrix").mat3,vec3:t("gl-matrix").vec3,loopController:void 0,version:t("./version.js"),_:t("underscore"),EventEmitter:t("events").EventEmitter,loop:function(t,e){return t&&void 0===e&&"[object Function]"==={}.toString.call(t)&&(e=t,t={}),this.loopController?t&&this.loopController.setupFrameEvents(t):this.loopController=new this.Controller(t),this.loopController.loop(e),this.loopController},plugin:function(t,e){this.Controller.plugin(t,e)}}},{"./circular_buffer":2,"./controller":5,"./finger":7,"./frame":8,"./gesture":9,"./hand":10,"./interaction_box":12,"./pointable":14,"./protocol":15,"./ui":16,"./version.js":19,events:21,"gl-matrix":23,underscore:24}],12:[function(t,e,n){var i=t("gl-matrix"),o=i.vec3,r=e.exports=function(t){this.valid=!0,this.center=t.center,this.size=t.size,this.width=t.size[0],this.height=t.size[1],this.depth=t.size[2]};r.prototype.denormalizePoint=function(t){return o.fromValues((t[0]-.5)*this.size[0]+this.center[0],(t[1]-.5)*this.size[1]+this.center[1],(t[2]-.5)*this.size[2]+this.center[2])},r.prototype.normalizePoint=function(t,e){var n=o.fromValues((t[0]-this.center[0])/this.size[0]+.5,(t[1]-this.center[1])/this.size[1]+.5,(t[2]-this.center[2])/this.size[2]+.5);return e&&(n[0]=Math.min(Math.max(n[0],0),1),n[1]=Math.min(Math.max(n[1],0),1),n[2]=Math.min(Math.max(n[2],0),1)),n},r.prototype.toString=function(){return"InteractionBox [ width:"+this.width+" | height:"+this.height+" | depth:"+this.depth+" ]"},r.Invalid={valid:!1}},{"gl-matrix":23}],13:[function(t,e,n){var i=e.exports=function(t){this.steps=[],this.controller=t};i.prototype.addStep=function(t){this.steps.push(t)},i.prototype.run=function(t){for(var e=this.steps.length,n=0;n!=e&&t;n++)t=this.steps[n](t);return t},i.prototype.removeStep=function(t){var e=this.steps.indexOf(t);if(-1===e)throw"Step not found in pipeline";this.steps.splice(e,1)},i.prototype.addWrappedStep=function(t,e){var n=this.controller,i=function(i){var o,r,s;for(o="frame"==t?[i]:i[t+"s"]||[],r=0,s=o.length;s>r;r++)e.call(n,o[r]);return i};return this.addStep(i),i}},{}],14:[function(t,e,n){var i=t("gl-matrix"),o=(i.vec3,e.exports=function(t){this.valid=!0,this.id=t.id,this.handId=t.handId,this.length=t.length,this.tool=t.tool,this.width=t.width,this.direction=t.direction,this.stabilizedTipPosition=t.stabilizedTipPosition,this.tipPosition=t.tipPosition,this.tipVelocity=t.tipVelocity,this.touchZone=t.touchZone,this.touchDistance=t.touchDistance,this.timeVisible=t.timeVisible});o.prototype.toString=function(){return"Pointable [ id:"+this.id+" "+this.length+"mmx | width:"+this.width+"mm | direction:"+this.direction+" ]"},o.prototype.hand=function(){return this.frame.hand(this.handId)},o.Invalid={valid:!1}},{"gl-matrix":23}],15:[function(t,e,n){var i=t("./frame"),o=(t("./hand"),t("./pointable"),t("./finger"),t("underscore")),r=t("events").EventEmitter,s=function(t){this.type=t.type,this.state=t.state};n.chooseProtocol=function(t){var e;switch(t.version){case 1:case 2:case 3:case 4:case 5:case 6:e=a(t),e.sendBackground=function(t,n){t.send(e.encode({background:n}))},e.sendFocused=function(t,n){t.send(e.encode({focused:n}))},e.sendOptimizeHMD=function(t,n){t.send(e.encode({optimizeHMD:n}))};break;default:throw"unrecognized version"}return e};var a=n.JSONProtocol=function(t){var e=function(t){if(t.event)return new s(t.event);e.emit("beforeFrameCreated",t);var n=new i(t);return e.emit("afterFrameCreated",n,t),n};return e.encode=function(t){return JSON.stringify(t)},e.version=t.version,e.serviceVersion=t.serviceVersion,e.versionLong="Version "+t.version,e.type="protocol",o.extend(e,r.prototype),e}},{"./finger":7,"./frame":8,"./hand":10,"./pointable":14,events:21,underscore:24}],16:[function(t,e,n){n.UI={Region:t("./ui/region"),Cursor:t("./ui/cursor")}},{"./ui/cursor":17,"./ui/region":18}],17:[function(t,e,n){e.exports=function(){return function(t){var e=t.pointables.sort(function(t,e){return t.z-e.z})[0];return e&&e.valid&&(t.cursorPosition=e.tipPosition),t}}},{}],18:[function(t,e,n){var i=t("events").EventEmitter,o=t("underscore"),r=e.exports=function(t,e){this.start=new Vector(t),this.end=new Vector(e),this.enteredFrame=null};r.prototype.hasPointables=function(t){for(var e=0;e!=t.pointables.length;e++){var n=t.pointables[e].tipPosition;if(n.x>=this.start.x&&n.x<=this.end.x&&n.y>=this.start.y&&n.y<=this.end.y&&n.z>=this.start.z&&n.z<=this.end.z)return!0}return!1},r.prototype.listener=function(t){var e=this;return t&&t.nearThreshold&&this.setupNearRegion(t.nearThreshold),function(t){return e.updatePosition(t)}},r.prototype.clipper=function(){var t=this;return function(e){return t.updatePosition(e),t.enteredFrame?e:null}},r.prototype.setupNearRegion=function(t){var e=this.nearRegion=new r([this.start.x-t,this.start.y-t,this.start.z-t],[this.end.x+t,this.end.y+t,this.end.z+t]),n=this;e.on("enter",function(t){n.emit("near",t)}),e.on("exit",function(t){n.emit("far",t)}),n.on("exit",function(t){n.emit("near",t)})},r.prototype.updatePosition=function(t){return this.nearRegion&&this.nearRegion.updatePosition(t),this.hasPointables(t)&&null==this.enteredFrame?(this.enteredFrame=t,this.emit("enter",this.enteredFrame)):this.hasPointables(t)||null==this.enteredFrame||(this.enteredFrame=null,this.emit("exit",this.enteredFrame)),t},r.prototype.normalize=function(t){return new Vector([(t.x-this.start.x)/(this.end.x-this.start.x),(t.y-this.start.y)/(this.end.y-this.start.y),(t.z-this.start.z)/(this.end.z-this.start.z)])},r.prototype.mapToXY=function(t,e,n){var i=this.normalize(t),o=i.x,r=i.y;return o>1?o=1:-1>o&&(o=-1),r>1?r=1:-1>r&&(r=-1),[(o+1)/2*e,(1-r)/2*n,i.z]},o.extend(r.prototype,i.prototype)},{events:21,underscore:24}],19:[function(t,e,n){e.exports={full:"0.6.4",major:0,minor:6,dot:4}},{}],20:[function(t,e,n){},{}],21:[function(t,e,n){function i(t,e){if(t.indexOf)return t.indexOf(e);for(var n=0;n<t.length;n++)if(e===t[n])return n;return-1}var o=t("__browserify_process");o.EventEmitter||(o.EventEmitter=function(){});var r=n.EventEmitter=o.EventEmitter,s="function"==typeof Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)},a=10;r.prototype.setMaxListeners=function(t){this._events||(this._events={}),this._events.maxListeners=t},r.prototype.emit=function(t){if("error"===t&&(!this._events||!this._events.error||s(this._events.error)&&!this._events.error.length))throw arguments[1]instanceof Error?arguments[1]:new Error("Uncaught, unspecified 'error' event.");if(!this._events)return!1;var e=this._events[t];if(!e)return!1;if("function"==typeof e){switch(arguments.length){case 1:e.call(this);break;case 2:e.call(this,arguments[1]);break;case 3:e.call(this,arguments[1],arguments[2]);break;default:var n=Array.prototype.slice.call(arguments,1);e.apply(this,n)}return!0}if(s(e)){for(var n=Array.prototype.slice.call(arguments,1),i=e.slice(),o=0,r=i.length;r>o;o++)i[o].apply(this,n);return!0}return!1},r.prototype.addListener=function(t,e){if("function"!=typeof e)throw new Error("addListener only takes instances of Function");if(this._events||(this._events={}),this.emit("newListener",t,e),this._events[t])if(s(this._events[t])){if(!this._events[t].warned){var n;n=void 0!==this._events.maxListeners?this._events.maxListeners:a,n&&n>0&&this._events[t].length>n&&(this._events[t].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[t].length),console.trace())}this._events[t].push(e)}else this._events[t]=[this._events[t],e];else this._events[t]=e;return this},r.prototype.on=r.prototype.addListener,r.prototype.once=function(t,e){var n=this;return n.on(t,function i(){n.removeListener(t,i),e.apply(this,arguments)}),this},r.prototype.removeListener=function(t,e){if("function"!=typeof e)throw new Error("removeListener only takes instances of Function");if(!this._events||!this._events[t])return this;var n=this._events[t];if(s(n)){var o=i(n,e);if(0>o)return this;n.splice(o,1),0==n.length&&delete this._events[t]}else this._events[t]===e&&delete this._events[t];return this},r.prototype.removeAllListeners=function(t){return 0===arguments.length?(this._events={},this):(t&&this._events&&this._events[t]&&(this._events[t]=null),this)},r.prototype.listeners=function(t){return this._events||(this._events={}),this._events[t]||(this._events[t]=[]),s(this._events[t])||(this._events[t]=[this._events[t]]),this._events[t]},r.listenerCount=function(t,e){var n;return n=t._events&&t._events[e]?"function"==typeof t._events[e]?1:t._events[e].length:0}},{__browserify_process:22}],22:[function(t,e,n){var i=e.exports={};i.nextTick=function(){var t="undefined"!=typeof window&&window.setImmediate,e="undefined"!=typeof window&&window.postMessage&&window.addEventListener;if(t)return function(t){return window.setImmediate(t)};if(e){var n=[];return window.addEventListener("message",function(t){var e=t.source;if((e===window||null===e)&&"process-tick"===t.data&&(t.stopPropagation(),n.length>0)){var i=n.shift();i()}},!0),function(t){n.push(t),window.postMessage("process-tick","*")}}return function(t){setTimeout(t,0)}}(),i.title="browser",i.browser=!0,i.env={},i.argv=[],i.binding=function(t){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(t){throw new Error("process.chdir is not supported")}},{}],23:[function(t,e,n){!function(t){"use strict";var e={};"undefined"==typeof n?"function"==typeof define&&"object"==typeof define.amd&&define.amd?(e.exports={},define(function(){return e.exports})):e.exports="undefined"!=typeof window?window:t:e.exports=n,function(t){if(!e)var e=1e-6;if(!n)var n="undefined"!=typeof Float32Array?Float32Array:Array;if(!i)var i=Math.random;var o={};o.setMatrixArrayType=function(t){n=t},"undefined"!=typeof t&&(t.glMatrix=o);var r=Math.PI/180;o.toRadian=function(t){return t*r};var s={};s.create=function(){var t=new n(2);return t[0]=0,t[1]=0,t},s.clone=function(t){var e=new n(2);return e[0]=t[0],e[1]=t[1],e},s.fromValues=function(t,e){var i=new n(2);return i[0]=t,i[1]=e,i},s.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t},s.set=function(t,e,n){return t[0]=e,t[1]=n,t},s.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t},s.subtract=function(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t},s.sub=s.subtract,s.multiply=function(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t},s.mul=s.multiply,s.divide=function(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t},s.div=s.divide,s.min=function(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t},s.max=function(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t},s.scale=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t},s.scaleAndAdd=function(t,e,n,i){return t[0]=e[0]+n[0]*i,t[1]=e[1]+n[1]*i,t},s.distance=function(t,e){var n=e[0]-t[0],i=e[1]-t[1];return Math.sqrt(n*n+i*i)},s.dist=s.distance,s.squaredDistance=function(t,e){var n=e[0]-t[0],i=e[1]-t[1];return n*n+i*i},s.sqrDist=s.squaredDistance,s.length=function(t){var e=t[0],n=t[1];return Math.sqrt(e*e+n*n)},s.len=s.length,s.squaredLength=function(t){var e=t[0],n=t[1];return e*e+n*n},s.sqrLen=s.squaredLength,s.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t},s.normalize=function(t,e){var n=e[0],i=e[1],o=n*n+i*i;return o>0&&(o=1/Math.sqrt(o),t[0]=e[0]*o,t[1]=e[1]*o),t},s.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]},s.cross=function(t,e,n){var i=e[0]*n[1]-e[1]*n[0];return t[0]=t[1]=0,t[2]=i,t},s.lerp=function(t,e,n,i){var o=e[0],r=e[1];return t[0]=o+i*(n[0]-o),t[1]=r+i*(n[1]-r),t},s.random=function(t,e){e=e||1;var n=2*i()*Math.PI;return t[0]=Math.cos(n)*e,t[1]=Math.sin(n)*e,t},s.transformMat2=function(t,e,n){var i=e[0],o=e[1];return t[0]=n[0]*i+n[2]*o,t[1]=n[1]*i+n[3]*o,t},s.transformMat2d=function(t,e,n){var i=e[0],o=e[1];return t[0]=n[0]*i+n[2]*o+n[4],t[1]=n[1]*i+n[3]*o+n[5],t},s.transformMat3=function(t,e,n){var i=e[0],o=e[1];return t[0]=n[0]*i+n[3]*o+n[6],t[1]=n[1]*i+n[4]*o+n[7],t},s.transformMat4=function(t,e,n){var i=e[0],o=e[1];return t[0]=n[0]*i+n[4]*o+n[12],t[1]=n[1]*i+n[5]*o+n[13],t},s.forEach=function(){var t=s.create();return function(e,n,i,o,r,s){var a,c;for(n||(n=2),i||(i=0),c=o?Math.min(o*n+i,e.length):e.length,a=i;c>a;a+=n)t[0]=e[a],t[1]=e[a+1],r(t,t,s),e[a]=t[0],e[a+1]=t[1];return e}}(),s.str=function(t){return"vec2("+t[0]+", "+t[1]+")"},"undefined"!=typeof t&&(t.vec2=s);var a={};a.create=function(){var t=new n(3);return t[0]=0,t[1]=0,t[2]=0,t},a.clone=function(t){var e=new n(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e},a.fromValues=function(t,e,i){var o=new n(3);return o[0]=t,o[1]=e,o[2]=i,o},a.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},a.set=function(t,e,n,i){return t[0]=e,t[1]=n,t[2]=i,t},a.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t},a.subtract=function(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t},a.sub=a.subtract,a.multiply=function(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t},a.mul=a.multiply,a.divide=function(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t},a.div=a.divide,a.min=function(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t},a.max=function(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t},a.scale=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t},a.scaleAndAdd=function(t,e,n,i){return t[0]=e[0]+n[0]*i,t[1]=e[1]+n[1]*i,t[2]=e[2]+n[2]*i,t},a.distance=function(t,e){var n=e[0]-t[0],i=e[1]-t[1],o=e[2]-t[2];return Math.sqrt(n*n+i*i+o*o)},a.dist=a.distance,a.squaredDistance=function(t,e){var n=e[0]-t[0],i=e[1]-t[1],o=e[2]-t[2];return n*n+i*i+o*o},a.sqrDist=a.squaredDistance,a.length=function(t){var e=t[0],n=t[1],i=t[2];return Math.sqrt(e*e+n*n+i*i)},a.len=a.length,a.squaredLength=function(t){var e=t[0],n=t[1],i=t[2];return e*e+n*n+i*i},a.sqrLen=a.squaredLength,a.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t},a.normalize=function(t,e){var n=e[0],i=e[1],o=e[2],r=n*n+i*i+o*o;return r>0&&(r=1/Math.sqrt(r),t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r),t},a.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]},a.cross=function(t,e,n){var i=e[0],o=e[1],r=e[2],s=n[0],a=n[1],c=n[2];return t[0]=o*c-r*a,t[1]=r*s-i*c,t[2]=i*a-o*s,t},a.lerp=function(t,e,n,i){var o=e[0],r=e[1],s=e[2];return t[0]=o+i*(n[0]-o),t[1]=r+i*(n[1]-r),t[2]=s+i*(n[2]-s),t},a.random=function(t,e){e=e||1;var n=2*i()*Math.PI,o=2*i()-1,r=Math.sqrt(1-o*o)*e;return t[0]=Math.cos(n)*r,t[1]=Math.sin(n)*r,t[2]=o*e,t},a.transformMat4=function(t,e,n){var i=e[0],o=e[1],r=e[2];return t[0]=n[0]*i+n[4]*o+n[8]*r+n[12],t[1]=n[1]*i+n[5]*o+n[9]*r+n[13],t[2]=n[2]*i+n[6]*o+n[10]*r+n[14],t},a.transformMat3=function(t,e,n){var i=e[0],o=e[1],r=e[2];return t[0]=i*n[0]+o*n[3]+r*n[6],t[1]=i*n[1]+o*n[4]+r*n[7],t[2]=i*n[2]+o*n[5]+r*n[8],t},a.transformQuat=function(t,e,n){var i=e[0],o=e[1],r=e[2],s=n[0],a=n[1],c=n[2],u=n[3],l=u*i+a*r-c*o,h=u*o+c*i-s*r,p=u*r+s*o-a*i,d=-s*i-a*o-c*r;return t[0]=l*u+d*-s+h*-c-p*-a,t[1]=h*u+d*-a+p*-s-l*-c,t[2]=p*u+d*-c+l*-a-h*-s,t},a.rotateX=function(t,e,n,i){var o=[],r=[];return o[0]=e[0]-n[0],o[1]=e[1]-n[1],o[2]=e[2]-n[2],r[0]=o[0],r[1]=o[1]*Math.cos(i)-o[2]*Math.sin(i),r[2]=o[1]*Math.sin(i)+o[2]*Math.cos(i),t[0]=r[0]+n[0],t[1]=r[1]+n[1],t[2]=r[2]+n[2],t},a.rotateY=function(t,e,n,i){var o=[],r=[];return o[0]=e[0]-n[0],o[1]=e[1]-n[1],o[2]=e[2]-n[2],r[0]=o[2]*Math.sin(i)+o[0]*Math.cos(i),r[1]=o[1],r[2]=o[2]*Math.cos(i)-o[0]*Math.sin(i),t[0]=r[0]+n[0],t[1]=r[1]+n[1],t[2]=r[2]+n[2],t},a.rotateZ=function(t,e,n,i){var o=[],r=[];return o[0]=e[0]-n[0],o[1]=e[1]-n[1],o[2]=e[2]-n[2],r[0]=o[0]*Math.cos(i)-o[1]*Math.sin(i),r[1]=o[0]*Math.sin(i)+o[1]*Math.cos(i),r[2]=o[2],t[0]=r[0]+n[0],t[1]=r[1]+n[1],t[2]=r[2]+n[2],t},a.forEach=function(){var t=a.create();return function(e,n,i,o,r,s){var a,c;for(n||(n=3),i||(i=0),c=o?Math.min(o*n+i,e.length):e.length,a=i;c>a;a+=n)t[0]=e[a],t[1]=e[a+1],t[2]=e[a+2],r(t,t,s),e[a]=t[0],e[a+1]=t[1],e[a+2]=t[2];return e}}(),a.str=function(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"},"undefined"!=typeof t&&(t.vec3=a);var c={};c.create=function(){var t=new n(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t},c.clone=function(t){var e=new n(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},c.fromValues=function(t,e,i,o){var r=new n(4);return r[0]=t,r[1]=e,r[2]=i,r[3]=o,r},c.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},c.set=function(t,e,n,i,o){return t[0]=e,t[1]=n,t[2]=i,t[3]=o,t},c.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t},c.subtract=function(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t},c.sub=c.subtract,c.multiply=function(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t[3]=e[3]*n[3],t},c.mul=c.multiply,c.divide=function(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t[3]=e[3]/n[3],t},c.div=c.divide,c.min=function(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t[3]=Math.min(e[3],n[3]),t},c.max=function(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t[3]=Math.max(e[3],n[3]),t},c.scale=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t},c.scaleAndAdd=function(t,e,n,i){return t[0]=e[0]+n[0]*i,t[1]=e[1]+n[1]*i,t[2]=e[2]+n[2]*i,t[3]=e[3]+n[3]*i,t},c.distance=function(t,e){var n=e[0]-t[0],i=e[1]-t[1],o=e[2]-t[2],r=e[3]-t[3];return Math.sqrt(n*n+i*i+o*o+r*r)},c.dist=c.distance,c.squaredDistance=function(t,e){var n=e[0]-t[0],i=e[1]-t[1],o=e[2]-t[2],r=e[3]-t[3];return n*n+i*i+o*o+r*r},c.sqrDist=c.squaredDistance,c.length=function(t){var e=t[0],n=t[1],i=t[2],o=t[3];return Math.sqrt(e*e+n*n+i*i+o*o)},c.len=c.length,c.squaredLength=function(t){var e=t[0],n=t[1],i=t[2],o=t[3];return e*e+n*n+i*i+o*o},c.sqrLen=c.squaredLength,c.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t},c.normalize=function(t,e){var n=e[0],i=e[1],o=e[2],r=e[3],s=n*n+i*i+o*o+r*r;return s>0&&(s=1/Math.sqrt(s),t[0]=e[0]*s,t[1]=e[1]*s,t[2]=e[2]*s,t[3]=e[3]*s),t},c.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]},c.lerp=function(t,e,n,i){var o=e[0],r=e[1],s=e[2],a=e[3];return t[0]=o+i*(n[0]-o),t[1]=r+i*(n[1]-r),t[2]=s+i*(n[2]-s),t[3]=a+i*(n[3]-a),t},c.random=function(t,e){return e=e||1,t[0]=i(),t[1]=i(),t[2]=i(),t[3]=i(),c.normalize(t,t),c.scale(t,t,e),t},c.transformMat4=function(t,e,n){var i=e[0],o=e[1],r=e[2],s=e[3];return t[0]=n[0]*i+n[4]*o+n[8]*r+n[12]*s,t[1]=n[1]*i+n[5]*o+n[9]*r+n[13]*s,t[2]=n[2]*i+n[6]*o+n[10]*r+n[14]*s,t[3]=n[3]*i+n[7]*o+n[11]*r+n[15]*s,t},c.transformQuat=function(t,e,n){var i=e[0],o=e[1],r=e[2],s=n[0],a=n[1],c=n[2],u=n[3],l=u*i+a*r-c*o,h=u*o+c*i-s*r,p=u*r+s*o-a*i,d=-s*i-a*o-c*r;return t[0]=l*u+d*-s+h*-c-p*-a,t[1]=h*u+d*-a+p*-s-l*-c,t[2]=p*u+d*-c+l*-a-h*-s,t},c.forEach=function(){var t=c.create();return function(e,n,i,o,r,s){var a,c;for(n||(n=4),i||(i=0),c=o?Math.min(o*n+i,e.length):e.length,a=i;c>a;a+=n)t[0]=e[a],t[1]=e[a+1],t[2]=e[a+2],t[3]=e[a+3],r(t,t,s),e[a]=t[0],e[a+1]=t[1],e[a+2]=t[2],e[a+3]=t[3];return e}}(),c.str=function(t){return"vec4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},"undefined"!=typeof t&&(t.vec4=c);var u={};u.create=function(){var t=new n(4);return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},u.clone=function(t){var e=new n(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},u.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},u.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},u.transpose=function(t,e){if(t===e){var n=e[1];t[1]=e[2],t[2]=n}else t[0]=e[0],t[1]=e[2],t[2]=e[1],t[3]=e[3];return t},u.invert=function(t,e){var n=e[0],i=e[1],o=e[2],r=e[3],s=n*r-o*i;return s?(s=1/s,t[0]=r*s,t[1]=-i*s,t[2]=-o*s,t[3]=n*s,t):null},u.adjoint=function(t,e){var n=e[0];return t[0]=e[3],t[1]=-e[1],t[2]=-e[2],t[3]=n,t},u.determinant=function(t){return t[0]*t[3]-t[2]*t[1]},u.multiply=function(t,e,n){var i=e[0],o=e[1],r=e[2],s=e[3],a=n[0],c=n[1],u=n[2],l=n[3];return t[0]=i*a+r*c,t[1]=o*a+s*c,t[2]=i*u+r*l,t[3]=o*u+s*l,t},u.mul=u.multiply,u.rotate=function(t,e,n){var i=e[0],o=e[1],r=e[2],s=e[3],a=Math.sin(n),c=Math.cos(n);return t[0]=i*c+r*a,t[1]=o*c+s*a,t[2]=i*-a+r*c,t[3]=o*-a+s*c,t},u.scale=function(t,e,n){var i=e[0],o=e[1],r=e[2],s=e[3],a=n[0],c=n[1];return t[0]=i*a,t[1]=o*a,t[2]=r*c,t[3]=s*c,t},u.str=function(t){return"mat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},u.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2))},u.LDU=function(t,e,n,i){return t[2]=i[2]/i[0],n[0]=i[0],n[1]=i[1],n[3]=i[3]-t[2]*n[1],[t,e,n]},"undefined"!=typeof t&&(t.mat2=u);var l={};l.create=function(){var t=new n(6);return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t},l.clone=function(t){var e=new n(6);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e},l.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t},l.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t},l.invert=function(t,e){var n=e[0],i=e[1],o=e[2],r=e[3],s=e[4],a=e[5],c=n*r-i*o;return c?(c=1/c,t[0]=r*c,t[1]=-i*c,t[2]=-o*c,t[3]=n*c,t[4]=(o*a-r*s)*c,t[5]=(i*s-n*a)*c,t):null},l.determinant=function(t){return t[0]*t[3]-t[1]*t[2]},l.multiply=function(t,e,n){var i=e[0],o=e[1],r=e[2],s=e[3],a=e[4],c=e[5],u=n[0],l=n[1],h=n[2],p=n[3],d=n[4],f=n[5];return t[0]=i*u+r*l,t[1]=o*u+s*l,t[2]=i*h+r*p,t[3]=o*h+s*p,t[4]=i*d+r*f+a,t[5]=o*d+s*f+c,t},l.mul=l.multiply,l.rotate=function(t,e,n){var i=e[0],o=e[1],r=e[2],s=e[3],a=e[4],c=e[5],u=Math.sin(n),l=Math.cos(n);return t[0]=i*l+r*u,t[1]=o*l+s*u,t[2]=i*-u+r*l,t[3]=o*-u+s*l,t[4]=a,t[5]=c,t},l.scale=function(t,e,n){var i=e[0],o=e[1],r=e[2],s=e[3],a=e[4],c=e[5],u=n[0],l=n[1];return t[0]=i*u,t[1]=o*u,t[2]=r*l,t[3]=s*l,t[4]=a,t[5]=c,t},l.translate=function(t,e,n){var i=e[0],o=e[1],r=e[2],s=e[3],a=e[4],c=e[5],u=n[0],l=n[1];return t[0]=i,t[1]=o,t[2]=r,t[3]=s,t[4]=i*u+r*l+a,t[5]=o*u+s*l+c,t},l.str=function(t){return"mat2d("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+")"},l.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+1)},"undefined"!=typeof t&&(t.mat2d=l);var h={};h.create=function(){var t=new n(9);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},h.fromMat4=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t},h.clone=function(t){var e=new n(9);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},h.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},h.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},h.transpose=function(t,e){if(t===e){var n=e[1],i=e[2],o=e[5];t[1]=e[3],t[2]=e[6],t[3]=n,t[5]=e[7],t[6]=i,t[7]=o}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t},h.invert=function(t,e){var n=e[0],i=e[1],o=e[2],r=e[3],s=e[4],a=e[5],c=e[6],u=e[7],l=e[8],h=l*s-a*u,p=-l*r+a*c,d=u*r-s*c,f=n*h+i*p+o*d;return f?(f=1/f,t[0]=h*f,t[1]=(-l*i+o*u)*f,t[2]=(a*i-o*s)*f,t[3]=p*f,t[4]=(l*n-o*c)*f,t[5]=(-a*n+o*r)*f,t[6]=d*f,t[7]=(-u*n+i*c)*f,t[8]=(s*n-i*r)*f,t):null},h.adjoint=function(t,e){var n=e[0],i=e[1],o=e[2],r=e[3],s=e[4],a=e[5],c=e[6],u=e[7],l=e[8];return t[0]=s*l-a*u,t[1]=o*u-i*l,t[2]=i*a-o*s,t[3]=a*c-r*l,t[4]=n*l-o*c,t[5]=o*r-n*a,t[6]=r*u-s*c,t[7]=i*c-n*u,t[8]=n*s-i*r,t},h.determinant=function(t){var e=t[0],n=t[1],i=t[2],o=t[3],r=t[4],s=t[5],a=t[6],c=t[7],u=t[8];return e*(u*r-s*c)+n*(-u*o+s*a)+i*(c*o-r*a)},h.multiply=function(t,e,n){var i=e[0],o=e[1],r=e[2],s=e[3],a=e[4],c=e[5],u=e[6],l=e[7],h=e[8],p=n[0],d=n[1],f=n[2],m=n[3],v=n[4],g=n[5],y=n[6],b=n[7],w=n[8];return t[0]=p*i+d*s+f*u,t[1]=p*o+d*a+f*l,t[2]=p*r+d*c+f*h,t[3]=m*i+v*s+g*u,t[4]=m*o+v*a+g*l,t[5]=m*r+v*c+g*h,t[6]=y*i+b*s+w*u,t[7]=y*o+b*a+w*l,t[8]=y*r+b*c+w*h,t},h.mul=h.multiply,h.translate=function(t,e,n){var i=e[0],o=e[1],r=e[2],s=e[3],a=e[4],c=e[5],u=e[6],l=e[7],h=e[8],p=n[0],d=n[1];return t[0]=i,t[1]=o,t[2]=r,t[3]=s,t[4]=a,t[5]=c,t[6]=p*i+d*s+u,t[7]=p*o+d*a+l,t[8]=p*r+d*c+h,t},h.rotate=function(t,e,n){var i=e[0],o=e[1],r=e[2],s=e[3],a=e[4],c=e[5],u=e[6],l=e[7],h=e[8],p=Math.sin(n),d=Math.cos(n);return t[0]=d*i+p*s,t[1]=d*o+p*a,t[2]=d*r+p*c,t[3]=d*s-p*i,t[4]=d*a-p*o,t[5]=d*c-p*r,t[6]=u,t[7]=l,t[8]=h,t},h.scale=function(t,e,n){var i=n[0],o=n[1];return t[0]=i*e[0],t[1]=i*e[1],t[2]=i*e[2],t[3]=o*e[3],t[4]=o*e[4],t[5]=o*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},h.fromMat2d=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=0,t[3]=e[2],t[4]=e[3],t[5]=0,t[6]=e[4],t[7]=e[5],t[8]=1,t},h.fromQuat=function(t,e){var n=e[0],i=e[1],o=e[2],r=e[3],s=n+n,a=i+i,c=o+o,u=n*s,l=i*s,h=i*a,p=o*s,d=o*a,f=o*c,m=r*s,v=r*a,g=r*c;return t[0]=1-h-f,t[3]=l-g,t[6]=p+v,t[1]=l+g,t[4]=1-u-f,t[7]=d-m,t[2]=p-v,t[5]=d+m,t[8]=1-u-h,t},h.normalFromMat4=function(t,e){var n=e[0],i=e[1],o=e[2],r=e[3],s=e[4],a=e[5],c=e[6],u=e[7],l=e[8],h=e[9],p=e[10],d=e[11],f=e[12],m=e[13],v=e[14],g=e[15],y=n*a-i*s,b=n*c-o*s,w=n*u-r*s,E=i*c-o*a,_=i*u-r*a,x=o*u-r*c,M=l*m-h*f,T=l*v-p*f,S=l*g-d*f,j=h*v-p*m,k=h*g-d*m,C=p*g-d*v,P=y*C-b*k+w*j+E*S-_*T+x*M;return P?(P=1/P,t[0]=(a*C-c*k+u*j)*P,t[1]=(c*S-s*C-u*T)*P,t[2]=(s*k-a*S+u*M)*P,t[3]=(o*k-i*C-r*j)*P,t[4]=(n*C-o*S+r*T)*P,t[5]=(i*S-n*k-r*M)*P,t[6]=(m*x-v*_+g*E)*P,t[7]=(v*w-f*x-g*b)*P,t[8]=(f*_-m*w+g*y)*P,t):null},h.str=function(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"},h.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2))},"undefined"!=typeof t&&(t.mat3=h);var p={};p.create=function(){var t=new n(16);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},p.clone=function(t){var e=new n(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},p.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},p.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},p.transpose=function(t,e){if(t===e){var n=e[1],i=e[2],o=e[3],r=e[6],s=e[7],a=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=i,t[9]=r,t[11]=e[14],t[12]=o,t[13]=s,t[14]=a}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t},p.invert=function(t,e){var n=e[0],i=e[1],o=e[2],r=e[3],s=e[4],a=e[5],c=e[6],u=e[7],l=e[8],h=e[9],p=e[10],d=e[11],f=e[12],m=e[13],v=e[14],g=e[15],y=n*a-i*s,b=n*c-o*s,w=n*u-r*s,E=i*c-o*a,_=i*u-r*a,x=o*u-r*c,M=l*m-h*f,T=l*v-p*f,S=l*g-d*f,j=h*v-p*m,k=h*g-d*m,C=p*g-d*v,P=y*C-b*k+w*j+E*S-_*T+x*M;return P?(P=1/P,t[0]=(a*C-c*k+u*j)*P,t[1]=(o*k-i*C-r*j)*P,t[2]=(m*x-v*_+g*E)*P,t[3]=(p*_-h*x-d*E)*P,t[4]=(c*S-s*C-u*T)*P,t[5]=(n*C-o*S+r*T)*P,t[6]=(v*w-f*x-g*b)*P,t[7]=(l*x-p*w+d*b)*P,t[8]=(s*k-a*S+u*M)*P,t[9]=(i*S-n*k-r*M)*P,t[10]=(f*_-m*w+g*y)*P,t[11]=(h*w-l*_-d*y)*P,t[12]=(a*T-s*j-c*M)*P,t[13]=(n*j-i*T+o*M)*P,t[14]=(m*b-f*E-v*y)*P,t[15]=(l*E-h*b+p*y)*P,t):null},p.adjoint=function(t,e){var n=e[0],i=e[1],o=e[2],r=e[3],s=e[4],a=e[5],c=e[6],u=e[7],l=e[8],h=e[9],p=e[10],d=e[11],f=e[12],m=e[13],v=e[14],g=e[15];return t[0]=a*(p*g-d*v)-h*(c*g-u*v)+m*(c*d-u*p),t[1]=-(i*(p*g-d*v)-h*(o*g-r*v)+m*(o*d-r*p)),t[2]=i*(c*g-u*v)-a*(o*g-r*v)+m*(o*u-r*c),t[3]=-(i*(c*d-u*p)-a*(o*d-r*p)+h*(o*u-r*c)),t[4]=-(s*(p*g-d*v)-l*(c*g-u*v)+f*(c*d-u*p)),t[5]=n*(p*g-d*v)-l*(o*g-r*v)+f*(o*d-r*p),t[6]=-(n*(c*g-u*v)-s*(o*g-r*v)+f*(o*u-r*c)),t[7]=n*(c*d-u*p)-s*(o*d-r*p)+l*(o*u-r*c),t[8]=s*(h*g-d*m)-l*(a*g-u*m)+f*(a*d-u*h),t[9]=-(n*(h*g-d*m)-l*(i*g-r*m)+f*(i*d-r*h)),t[10]=n*(a*g-u*m)-s*(i*g-r*m)+f*(i*u-r*a),t[11]=-(n*(a*d-u*h)-s*(i*d-r*h)+l*(i*u-r*a)),t[12]=-(s*(h*v-p*m)-l*(a*v-c*m)+f*(a*p-c*h)),t[13]=n*(h*v-p*m)-l*(i*v-o*m)+f*(i*p-o*h),t[14]=-(n*(a*v-c*m)-s*(i*v-o*m)+f*(i*c-o*a)),t[15]=n*(a*p-c*h)-s*(i*p-o*h)+l*(i*c-o*a),t},p.determinant=function(t){var e=t[0],n=t[1],i=t[2],o=t[3],r=t[4],s=t[5],a=t[6],c=t[7],u=t[8],l=t[9],h=t[10],p=t[11],d=t[12],f=t[13],m=t[14],v=t[15],g=e*s-n*r,y=e*a-i*r,b=e*c-o*r,w=n*a-i*s,E=n*c-o*s,_=i*c-o*a,x=u*f-l*d,M=u*m-h*d,T=u*v-p*d,S=l*m-h*f,j=l*v-p*f,k=h*v-p*m;return g*k-y*j+b*S+w*T-E*M+_*x},p.multiply=function(t,e,n){var i=e[0],o=e[1],r=e[2],s=e[3],a=e[4],c=e[5],u=e[6],l=e[7],h=e[8],p=e[9],d=e[10],f=e[11],m=e[12],v=e[13],g=e[14],y=e[15],b=n[0],w=n[1],E=n[2],_=n[3];return t[0]=b*i+w*a+E*h+_*m,t[1]=b*o+w*c+E*p+_*v,t[2]=b*r+w*u+E*d+_*g,t[3]=b*s+w*l+E*f+_*y,b=n[4],w=n[5],E=n[6],_=n[7],t[4]=b*i+w*a+E*h+_*m,t[5]=b*o+w*c+E*p+_*v,t[6]=b*r+w*u+E*d+_*g,t[7]=b*s+w*l+E*f+_*y,b=n[8],w=n[9],E=n[10],_=n[11],t[8]=b*i+w*a+E*h+_*m,t[9]=b*o+w*c+E*p+_*v,t[10]=b*r+w*u+E*d+_*g,t[11]=b*s+w*l+E*f+_*y,b=n[12],w=n[13],E=n[14],_=n[15],t[12]=b*i+w*a+E*h+_*m,t[13]=b*o+w*c+E*p+_*v,t[14]=b*r+w*u+E*d+_*g,t[15]=b*s+w*l+E*f+_*y,t},p.mul=p.multiply,p.translate=function(t,e,n){var i,o,r,s,a,c,u,l,h,p,d,f,m=n[0],v=n[1],g=n[2];return e===t?(t[12]=e[0]*m+e[4]*v+e[8]*g+e[12],t[13]=e[1]*m+e[5]*v+e[9]*g+e[13],t[14]=e[2]*m+e[6]*v+e[10]*g+e[14],t[15]=e[3]*m+e[7]*v+e[11]*g+e[15]):(i=e[0],o=e[1],r=e[2],s=e[3],a=e[4],c=e[5],u=e[6],l=e[7],h=e[8],p=e[9],d=e[10],f=e[11],t[0]=i,t[1]=o,t[2]=r,t[3]=s,t[4]=a,t[5]=c,t[6]=u,t[7]=l,t[8]=h,t[9]=p,t[10]=d,t[11]=f,t[12]=i*m+a*v+h*g+e[12],t[13]=o*m+c*v+p*g+e[13],t[14]=r*m+u*v+d*g+e[14],t[15]=s*m+l*v+f*g+e[15]),t},p.scale=function(t,e,n){var i=n[0],o=n[1],r=n[2];return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t[4]=e[4]*o,t[5]=e[5]*o,t[6]=e[6]*o,t[7]=e[7]*o,t[8]=e[8]*r,t[9]=e[9]*r,t[10]=e[10]*r,t[11]=e[11]*r,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},p.rotate=function(t,n,i,o){var r,s,a,c,u,l,h,p,d,f,m,v,g,y,b,w,E,_,x,M,T,S,j,k,C=o[0],P=o[1],O=o[2],L=Math.sqrt(C*C+P*P+O*O);return Math.abs(L)<e?null:(L=1/L,C*=L,P*=L,O*=L,r=Math.sin(i),s=Math.cos(i),a=1-s,c=n[0],u=n[1],l=n[2],h=n[3],p=n[4],d=n[5],f=n[6],m=n[7],v=n[8],g=n[9],y=n[10],b=n[11],w=C*C*a+s,E=P*C*a+O*r,_=O*C*a-P*r,x=C*P*a-O*r,M=P*P*a+s,T=O*P*a+C*r,S=C*O*a+P*r,j=P*O*a-C*r,k=O*O*a+s,t[0]=c*w+p*E+v*_,t[1]=u*w+d*E+g*_,t[2]=l*w+f*E+y*_,t[3]=h*w+m*E+b*_,t[4]=c*x+p*M+v*T,t[5]=u*x+d*M+g*T,t[6]=l*x+f*M+y*T,t[7]=h*x+m*M+b*T,t[8]=c*S+p*j+v*k,t[9]=u*S+d*j+g*k,t[10]=l*S+f*j+y*k,t[11]=h*S+m*j+b*k,n!==t&&(t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15]),t)},p.rotateX=function(t,e,n){var i=Math.sin(n),o=Math.cos(n),r=e[4],s=e[5],a=e[6],c=e[7],u=e[8],l=e[9],h=e[10],p=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=r*o+u*i,t[5]=s*o+l*i,t[6]=a*o+h*i,t[7]=c*o+p*i,t[8]=u*o-r*i,t[9]=l*o-s*i,t[10]=h*o-a*i,t[11]=p*o-c*i,t},p.rotateY=function(t,e,n){var i=Math.sin(n),o=Math.cos(n),r=e[0],s=e[1],a=e[2],c=e[3],u=e[8],l=e[9],h=e[10],p=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=r*o-u*i,t[1]=s*o-l*i,t[2]=a*o-h*i,t[3]=c*o-p*i,t[8]=r*i+u*o,t[9]=s*i+l*o,t[10]=a*i+h*o,t[11]=c*i+p*o,t},p.rotateZ=function(t,e,n){var i=Math.sin(n),o=Math.cos(n),r=e[0],s=e[1],a=e[2],c=e[3],u=e[4],l=e[5],h=e[6],p=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=r*o+u*i,t[1]=s*o+l*i,t[2]=a*o+h*i,t[3]=c*o+p*i,t[4]=u*o-r*i,t[5]=l*o-s*i,t[6]=h*o-a*i,t[7]=p*o-c*i,t},p.fromRotationTranslation=function(t,e,n){var i=e[0],o=e[1],r=e[2],s=e[3],a=i+i,c=o+o,u=r+r,l=i*a,h=i*c,p=i*u,d=o*c,f=o*u,m=r*u,v=s*a,g=s*c,y=s*u;
return t[0]=1-(d+m),t[1]=h+y,t[2]=p-g,t[3]=0,t[4]=h-y,t[5]=1-(l+m),t[6]=f+v,t[7]=0,t[8]=p+g,t[9]=f-v,t[10]=1-(l+d),t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t},p.fromQuat=function(t,e){var n=e[0],i=e[1],o=e[2],r=e[3],s=n+n,a=i+i,c=o+o,u=n*s,l=i*s,h=i*a,p=o*s,d=o*a,f=o*c,m=r*s,v=r*a,g=r*c;return t[0]=1-h-f,t[1]=l+g,t[2]=p-v,t[3]=0,t[4]=l-g,t[5]=1-u-f,t[6]=d+m,t[7]=0,t[8]=p+v,t[9]=d-m,t[10]=1-u-h,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},p.frustum=function(t,e,n,i,o,r,s){var a=1/(n-e),c=1/(o-i),u=1/(r-s);return t[0]=2*r*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*r*c,t[6]=0,t[7]=0,t[8]=(n+e)*a,t[9]=(o+i)*c,t[10]=(s+r)*u,t[11]=-1,t[12]=0,t[13]=0,t[14]=s*r*2*u,t[15]=0,t},p.perspective=function(t,e,n,i,o){var r=1/Math.tan(e/2),s=1/(i-o);return t[0]=r/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=r,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=(o+i)*s,t[11]=-1,t[12]=0,t[13]=0,t[14]=2*o*i*s,t[15]=0,t},p.ortho=function(t,e,n,i,o,r,s){var a=1/(e-n),c=1/(i-o),u=1/(r-s);return t[0]=-2*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*c,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*u,t[11]=0,t[12]=(e+n)*a,t[13]=(o+i)*c,t[14]=(s+r)*u,t[15]=1,t},p.lookAt=function(t,n,i,o){var r,s,a,c,u,l,h,d,f,m,v=n[0],g=n[1],y=n[2],b=o[0],w=o[1],E=o[2],_=i[0],x=i[1],M=i[2];return Math.abs(v-_)<e&&Math.abs(g-x)<e&&Math.abs(y-M)<e?p.identity(t):(h=v-_,d=g-x,f=y-M,m=1/Math.sqrt(h*h+d*d+f*f),h*=m,d*=m,f*=m,r=w*f-E*d,s=E*h-b*f,a=b*d-w*h,m=Math.sqrt(r*r+s*s+a*a),m?(m=1/m,r*=m,s*=m,a*=m):(r=0,s=0,a=0),c=d*a-f*s,u=f*r-h*a,l=h*s-d*r,m=Math.sqrt(c*c+u*u+l*l),m?(m=1/m,c*=m,u*=m,l*=m):(c=0,u=0,l=0),t[0]=r,t[1]=c,t[2]=h,t[3]=0,t[4]=s,t[5]=u,t[6]=d,t[7]=0,t[8]=a,t[9]=l,t[10]=f,t[11]=0,t[12]=-(r*v+s*g+a*y),t[13]=-(c*v+u*g+l*y),t[14]=-(h*v+d*g+f*y),t[15]=1,t)},p.str=function(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"},p.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2)+Math.pow(t[9],2)+Math.pow(t[10],2)+Math.pow(t[11],2)+Math.pow(t[12],2)+Math.pow(t[13],2)+Math.pow(t[14],2)+Math.pow(t[15],2))},"undefined"!=typeof t&&(t.mat4=p);var d={};d.create=function(){var t=new n(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t},d.rotationTo=function(){var t=a.create(),e=a.fromValues(1,0,0),n=a.fromValues(0,1,0);return function(i,o,r){var s=a.dot(o,r);return-.999999>s?(a.cross(t,e,o),a.length(t)<1e-6&&a.cross(t,n,o),a.normalize(t,t),d.setAxisAngle(i,t,Math.PI),i):s>.999999?(i[0]=0,i[1]=0,i[2]=0,i[3]=1,i):(a.cross(t,o,r),i[0]=t[0],i[1]=t[1],i[2]=t[2],i[3]=1+s,d.normalize(i,i))}}(),d.setAxes=function(){var t=h.create();return function(e,n,i,o){return t[0]=i[0],t[3]=i[1],t[6]=i[2],t[1]=o[0],t[4]=o[1],t[7]=o[2],t[2]=-n[0],t[5]=-n[1],t[8]=-n[2],d.normalize(e,d.fromMat3(e,t))}}(),d.clone=c.clone,d.fromValues=c.fromValues,d.copy=c.copy,d.set=c.set,d.identity=function(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t},d.setAxisAngle=function(t,e,n){n=.5*n;var i=Math.sin(n);return t[0]=i*e[0],t[1]=i*e[1],t[2]=i*e[2],t[3]=Math.cos(n),t},d.add=c.add,d.multiply=function(t,e,n){var i=e[0],o=e[1],r=e[2],s=e[3],a=n[0],c=n[1],u=n[2],l=n[3];return t[0]=i*l+s*a+o*u-r*c,t[1]=o*l+s*c+r*a-i*u,t[2]=r*l+s*u+i*c-o*a,t[3]=s*l-i*a-o*c-r*u,t},d.mul=d.multiply,d.scale=c.scale,d.rotateX=function(t,e,n){n*=.5;var i=e[0],o=e[1],r=e[2],s=e[3],a=Math.sin(n),c=Math.cos(n);return t[0]=i*c+s*a,t[1]=o*c+r*a,t[2]=r*c-o*a,t[3]=s*c-i*a,t},d.rotateY=function(t,e,n){n*=.5;var i=e[0],o=e[1],r=e[2],s=e[3],a=Math.sin(n),c=Math.cos(n);return t[0]=i*c-r*a,t[1]=o*c+s*a,t[2]=r*c+i*a,t[3]=s*c-o*a,t},d.rotateZ=function(t,e,n){n*=.5;var i=e[0],o=e[1],r=e[2],s=e[3],a=Math.sin(n),c=Math.cos(n);return t[0]=i*c+o*a,t[1]=o*c-i*a,t[2]=r*c+s*a,t[3]=s*c-r*a,t},d.calculateW=function(t,e){var n=e[0],i=e[1],o=e[2];return t[0]=n,t[1]=i,t[2]=o,t[3]=-Math.sqrt(Math.abs(1-n*n-i*i-o*o)),t},d.dot=c.dot,d.lerp=c.lerp,d.slerp=function(t,e,n,i){var o,r,s,a,c,u=e[0],l=e[1],h=e[2],p=e[3],d=n[0],f=n[1],m=n[2],v=n[3];return r=u*d+l*f+h*m+p*v,0>r&&(r=-r,d=-d,f=-f,m=-m,v=-v),1-r>1e-6?(o=Math.acos(r),s=Math.sin(o),a=Math.sin((1-i)*o)/s,c=Math.sin(i*o)/s):(a=1-i,c=i),t[0]=a*u+c*d,t[1]=a*l+c*f,t[2]=a*h+c*m,t[3]=a*p+c*v,t},d.invert=function(t,e){var n=e[0],i=e[1],o=e[2],r=e[3],s=n*n+i*i+o*o+r*r,a=s?1/s:0;return t[0]=-n*a,t[1]=-i*a,t[2]=-o*a,t[3]=r*a,t},d.conjugate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t},d.length=c.length,d.len=d.length,d.squaredLength=c.squaredLength,d.sqrLen=d.squaredLength,d.normalize=c.normalize,d.fromMat3=function(t,e){var n,i=e[0]+e[4]+e[8];if(i>0)n=Math.sqrt(i+1),t[3]=.5*n,n=.5/n,t[0]=(e[7]-e[5])*n,t[1]=(e[2]-e[6])*n,t[2]=(e[3]-e[1])*n;else{var o=0;e[4]>e[0]&&(o=1),e[8]>e[3*o+o]&&(o=2);var r=(o+1)%3,s=(o+2)%3;n=Math.sqrt(e[3*o+o]-e[3*r+r]-e[3*s+s]+1),t[o]=.5*n,n=.5/n,t[3]=(e[3*s+r]-e[3*r+s])*n,t[r]=(e[3*r+o]+e[3*o+r])*n,t[s]=(e[3*s+o]+e[3*o+s])*n}return t},d.str=function(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},"undefined"!=typeof t&&(t.quat=d)}(e.exports)}(this)},{}],24:[function(t,e,n){(function(){var t=this,i=t._,o={},r=Array.prototype,s=Object.prototype,a=Function.prototype,c=r.push,u=r.slice,l=r.concat,h=s.toString,p=s.hasOwnProperty,d=r.forEach,f=r.map,m=r.reduce,v=r.reduceRight,g=r.filter,y=r.every,b=r.some,w=r.indexOf,E=r.lastIndexOf,_=Array.isArray,x=Object.keys,M=a.bind,T=function(t){return t instanceof T?t:this instanceof T?void(this._wrapped=t):new T(t)};"undefined"!=typeof n?("undefined"!=typeof e&&e.exports&&(n=e.exports=T),n._=T):t._=T,T.VERSION="1.4.4";var S=T.each=T.forEach=function(t,e,n){if(null!=t)if(d&&t.forEach===d)t.forEach(e,n);else if(t.length===+t.length){for(var i=0,r=t.length;r>i;i++)if(e.call(n,t[i],i,t)===o)return}else for(var s in t)if(T.has(t,s)&&e.call(n,t[s],s,t)===o)return};T.map=T.collect=function(t,e,n){var i=[];return null==t?i:f&&t.map===f?t.map(e,n):(S(t,function(t,o,r){i[i.length]=e.call(n,t,o,r)}),i)};var j="Reduce of empty array with no initial value";T.reduce=T.foldl=T.inject=function(t,e,n,i){var o=arguments.length>2;if(null==t&&(t=[]),m&&t.reduce===m)return i&&(e=T.bind(e,i)),o?t.reduce(e,n):t.reduce(e);if(S(t,function(t,r,s){o?n=e.call(i,n,t,r,s):(n=t,o=!0)}),!o)throw new TypeError(j);return n},T.reduceRight=T.foldr=function(t,e,n,i){var o=arguments.length>2;if(null==t&&(t=[]),v&&t.reduceRight===v)return i&&(e=T.bind(e,i)),o?t.reduceRight(e,n):t.reduceRight(e);var r=t.length;if(r!==+r){var s=T.keys(t);r=s.length}if(S(t,function(a,c,u){c=s?s[--r]:--r,o?n=e.call(i,n,t[c],c,u):(n=t[c],o=!0)}),!o)throw new TypeError(j);return n},T.find=T.detect=function(t,e,n){var i;return k(t,function(t,o,r){return e.call(n,t,o,r)?(i=t,!0):void 0}),i},T.filter=T.select=function(t,e,n){var i=[];return null==t?i:g&&t.filter===g?t.filter(e,n):(S(t,function(t,o,r){e.call(n,t,o,r)&&(i[i.length]=t)}),i)},T.reject=function(t,e,n){return T.filter(t,function(t,i,o){return!e.call(n,t,i,o)},n)},T.every=T.all=function(t,e,n){e||(e=T.identity);var i=!0;return null==t?i:y&&t.every===y?t.every(e,n):(S(t,function(t,r,s){return(i=i&&e.call(n,t,r,s))?void 0:o}),!!i)};var k=T.some=T.any=function(t,e,n){e||(e=T.identity);var i=!1;return null==t?i:b&&t.some===b?t.some(e,n):(S(t,function(t,r,s){return i||(i=e.call(n,t,r,s))?o:void 0}),!!i)};T.contains=T.include=function(t,e){return null==t?!1:w&&t.indexOf===w?-1!=t.indexOf(e):k(t,function(t){return t===e})},T.invoke=function(t,e){var n=u.call(arguments,2),i=T.isFunction(e);return T.map(t,function(t){return(i?e:t[e]).apply(t,n)})},T.pluck=function(t,e){return T.map(t,function(t){return t[e]})},T.where=function(t,e,n){return T.isEmpty(e)?n?null:[]:T[n?"find":"filter"](t,function(t){for(var n in e)if(e[n]!==t[n])return!1;return!0})},T.findWhere=function(t,e){return T.where(t,e,!0)},T.max=function(t,e,n){if(!e&&T.isArray(t)&&t[0]===+t[0]&&t.length<65535)return Math.max.apply(Math,t);if(!e&&T.isEmpty(t))return-(1/0);var i={computed:-(1/0),value:-(1/0)};return S(t,function(t,o,r){var s=e?e.call(n,t,o,r):t;s>=i.computed&&(i={value:t,computed:s})}),i.value},T.min=function(t,e,n){if(!e&&T.isArray(t)&&t[0]===+t[0]&&t.length<65535)return Math.min.apply(Math,t);if(!e&&T.isEmpty(t))return 1/0;var i={computed:1/0,value:1/0};return S(t,function(t,o,r){var s=e?e.call(n,t,o,r):t;s<i.computed&&(i={value:t,computed:s})}),i.value},T.shuffle=function(t){var e,n=0,i=[];return S(t,function(t){e=T.random(n++),i[n-1]=i[e],i[e]=t}),i};var C=function(t){return T.isFunction(t)?t:function(e){return e[t]}};T.sortBy=function(t,e,n){var i=C(e);return T.pluck(T.map(t,function(t,e,o){return{value:t,index:e,criteria:i.call(n,t,e,o)}}).sort(function(t,e){var n=t.criteria,i=e.criteria;if(n!==i){if(n>i||void 0===n)return 1;if(i>n||void 0===i)return-1}return t.index<e.index?-1:1}),"value")};var P=function(t,e,n,i){var o={},r=C(e||T.identity);return S(t,function(e,s){var a=r.call(n,e,s,t);i(o,a,e)}),o};T.groupBy=function(t,e,n){return P(t,e,n,function(t,e,n){(T.has(t,e)?t[e]:t[e]=[]).push(n)})},T.countBy=function(t,e,n){return P(t,e,n,function(t,e){T.has(t,e)||(t[e]=0),t[e]++})},T.sortedIndex=function(t,e,n,i){n=null==n?T.identity:C(n);for(var o=n.call(i,e),r=0,s=t.length;s>r;){var a=r+s>>>1;n.call(i,t[a])<o?r=a+1:s=a}return r},T.toArray=function(t){return t?T.isArray(t)?u.call(t):t.length===+t.length?T.map(t,T.identity):T.values(t):[]},T.size=function(t){return null==t?0:t.length===+t.length?t.length:T.keys(t).length},T.first=T.head=T.take=function(t,e,n){return null==t?void 0:null==e||n?t[0]:u.call(t,0,e)},T.initial=function(t,e,n){return u.call(t,0,t.length-(null==e||n?1:e))},T.last=function(t,e,n){return null==t?void 0:null==e||n?t[t.length-1]:u.call(t,Math.max(t.length-e,0))},T.rest=T.tail=T.drop=function(t,e,n){return u.call(t,null==e||n?1:e)},T.compact=function(t){return T.filter(t,T.identity)};var O=function(t,e,n){return S(t,function(t){T.isArray(t)?e?c.apply(n,t):O(t,e,n):n.push(t)}),n};T.flatten=function(t,e){return O(t,e,[])},T.without=function(t){return T.difference(t,u.call(arguments,1))},T.uniq=T.unique=function(t,e,n,i){T.isFunction(e)&&(i=n,n=e,e=!1);var o=n?T.map(t,n,i):t,r=[],s=[];return S(o,function(n,i){(e?i&&s[s.length-1]===n:T.contains(s,n))||(s.push(n),r.push(t[i]))}),r},T.union=function(){return T.uniq(l.apply(r,arguments))},T.intersection=function(t){var e=u.call(arguments,1);return T.filter(T.uniq(t),function(t){return T.every(e,function(e){return T.indexOf(e,t)>=0})})},T.difference=function(t){var e=l.apply(r,u.call(arguments,1));return T.filter(t,function(t){return!T.contains(e,t)})},T.zip=function(){for(var t=u.call(arguments),e=T.max(T.pluck(t,"length")),n=new Array(e),i=0;e>i;i++)n[i]=T.pluck(t,""+i);return n},T.object=function(t,e){if(null==t)return{};for(var n={},i=0,o=t.length;o>i;i++)e?n[t[i]]=e[i]:n[t[i][0]]=t[i][1];return n},T.indexOf=function(t,e,n){if(null==t)return-1;var i=0,o=t.length;if(n){if("number"!=typeof n)return i=T.sortedIndex(t,e),t[i]===e?i:-1;i=0>n?Math.max(0,o+n):n}if(w&&t.indexOf===w)return t.indexOf(e,n);for(;o>i;i++)if(t[i]===e)return i;return-1},T.lastIndexOf=function(t,e,n){if(null==t)return-1;var i=null!=n;if(E&&t.lastIndexOf===E)return i?t.lastIndexOf(e,n):t.lastIndexOf(e);for(var o=i?n:t.length;o--;)if(t[o]===e)return o;return-1},T.range=function(t,e,n){arguments.length<=1&&(e=t||0,t=0),n=arguments[2]||1;for(var i=Math.max(Math.ceil((e-t)/n),0),o=0,r=new Array(i);i>o;)r[o++]=t,t+=n;return r},T.bind=function(t,e){if(t.bind===M&&M)return M.apply(t,u.call(arguments,1));var n=u.call(arguments,2);return function(){return t.apply(e,n.concat(u.call(arguments)))}},T.partial=function(t){var e=u.call(arguments,1);return function(){return t.apply(this,e.concat(u.call(arguments)))}},T.bindAll=function(t){var e=u.call(arguments,1);return 0===e.length&&(e=T.functions(t)),S(e,function(e){t[e]=T.bind(t[e],t)}),t},T.memoize=function(t,e){var n={};return e||(e=T.identity),function(){var i=e.apply(this,arguments);return T.has(n,i)?n[i]:n[i]=t.apply(this,arguments)}},T.delay=function(t,e){var n=u.call(arguments,2);return setTimeout(function(){return t.apply(null,n)},e)},T.defer=function(t){return T.delay.apply(T,[t,1].concat(u.call(arguments,1)))},T.throttle=function(t,e){var n,i,o,r,s=0,a=function(){s=new Date,o=null,r=t.apply(n,i)};return function(){var c=new Date,u=e-(c-s);return n=this,i=arguments,0>=u?(clearTimeout(o),o=null,s=c,r=t.apply(n,i)):o||(o=setTimeout(a,u)),r}},T.debounce=function(t,e,n){var i,o;return function(){var r=this,s=arguments,a=function(){i=null,n||(o=t.apply(r,s))},c=n&&!i;return clearTimeout(i),i=setTimeout(a,e),c&&(o=t.apply(r,s)),o}},T.once=function(t){var e,n=!1;return function(){return n?e:(n=!0,e=t.apply(this,arguments),t=null,e)}},T.wrap=function(t,e){return function(){var n=[t];return c.apply(n,arguments),e.apply(this,n)}},T.compose=function(){var t=arguments;return function(){for(var e=arguments,n=t.length-1;n>=0;n--)e=[t[n].apply(this,e)];return e[0]}},T.after=function(t,e){return 0>=t?e():function(){return--t<1?e.apply(this,arguments):void 0}},T.keys=x||function(t){if(t!==Object(t))throw new TypeError("Invalid object");var e=[];for(var n in t)T.has(t,n)&&(e[e.length]=n);return e},T.values=function(t){var e=[];for(var n in t)T.has(t,n)&&e.push(t[n]);return e},T.pairs=function(t){var e=[];for(var n in t)T.has(t,n)&&e.push([n,t[n]]);return e},T.invert=function(t){var e={};for(var n in t)T.has(t,n)&&(e[t[n]]=n);return e},T.functions=T.methods=function(t){var e=[];for(var n in t)T.isFunction(t[n])&&e.push(n);return e.sort()},T.extend=function(t){return S(u.call(arguments,1),function(e){if(e)for(var n in e)t[n]=e[n]}),t},T.pick=function(t){var e={},n=l.apply(r,u.call(arguments,1));return S(n,function(n){n in t&&(e[n]=t[n])}),e},T.omit=function(t){var e={},n=l.apply(r,u.call(arguments,1));for(var i in t)T.contains(n,i)||(e[i]=t[i]);return e},T.defaults=function(t){return S(u.call(arguments,1),function(e){if(e)for(var n in e)null==t[n]&&(t[n]=e[n])}),t},T.clone=function(t){return T.isObject(t)?T.isArray(t)?t.slice():T.extend({},t):t},T.tap=function(t,e){return e(t),t};var L=function(t,e,n,i){if(t===e)return 0!==t||1/t==1/e;if(null==t||null==e)return t===e;t instanceof T&&(t=t._wrapped),e instanceof T&&(e=e._wrapped);var o=h.call(t);if(o!=h.call(e))return!1;switch(o){case"[object String]":return t==String(e);case"[object Number]":return t!=+t?e!=+e:0==t?1/t==1/e:t==+e;case"[object Date]":case"[object Boolean]":return+t==+e;case"[object RegExp]":return t.source==e.source&&t.global==e.global&&t.multiline==e.multiline&&t.ignoreCase==e.ignoreCase}if("object"!=typeof t||"object"!=typeof e)return!1;for(var r=n.length;r--;)if(n[r]==t)return i[r]==e;n.push(t),i.push(e);var s=0,a=!0;if("[object Array]"==o){if(s=t.length,a=s==e.length)for(;s--&&(a=L(t[s],e[s],n,i)););}else{var c=t.constructor,u=e.constructor;if(c!==u&&!(T.isFunction(c)&&c instanceof c&&T.isFunction(u)&&u instanceof u))return!1;for(var l in t)if(T.has(t,l)&&(s++,!(a=T.has(e,l)&&L(t[l],e[l],n,i))))break;if(a){for(l in e)if(T.has(e,l)&&!s--)break;a=!s}}return n.pop(),i.pop(),a};T.isEqual=function(t,e){return L(t,e,[],[])},T.isEmpty=function(t){if(null==t)return!0;if(T.isArray(t)||T.isString(t))return 0===t.length;for(var e in t)if(T.has(t,e))return!1;return!0},T.isElement=function(t){return!(!t||1!==t.nodeType)},T.isArray=_||function(t){return"[object Array]"==h.call(t)},T.isObject=function(t){return t===Object(t)},S(["Arguments","Function","String","Number","Date","RegExp"],function(t){T["is"+t]=function(e){return h.call(e)=="[object "+t+"]"}}),T.isArguments(arguments)||(T.isArguments=function(t){return!(!t||!T.has(t,"callee"))}),"function"!=typeof/./&&(T.isFunction=function(t){return"function"==typeof t}),T.isFinite=function(t){return isFinite(t)&&!isNaN(parseFloat(t))},T.isNaN=function(t){return T.isNumber(t)&&t!=+t},T.isBoolean=function(t){return t===!0||t===!1||"[object Boolean]"==h.call(t)},T.isNull=function(t){return null===t},T.isUndefined=function(t){return void 0===t},T.has=function(t,e){return p.call(t,e)},T.noConflict=function(){return t._=i,this},T.identity=function(t){return t},T.times=function(t,e,n){for(var i=Array(t),o=0;t>o;o++)i[o]=e.call(n,o);return i},T.random=function(t,e){return null==e&&(e=t,t=0),t+Math.floor(Math.random()*(e-t+1))};var N={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"}};N.unescape=T.invert(N.escape);var A={escape:new RegExp("["+T.keys(N.escape).join("")+"]","g"),unescape:new RegExp("("+T.keys(N.unescape).join("|")+")","g")};T.each(["escape","unescape"],function(t){T[t]=function(e){return null==e?"":(""+e).replace(A[t],function(e){return N[t][e]})}}),T.result=function(t,e){if(null==t)return null;var n=t[e];return T.isFunction(n)?n.call(t):n},T.mixin=function(t){S(T.functions(t),function(e){var n=T[e]=t[e];T.prototype[e]=function(){var t=[this._wrapped];return c.apply(t,arguments),F.call(this,n.apply(T,t))}})};var R=0;T.uniqueId=function(t){var e=++R+"";return t?t+e:e},T.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var H=/(.)^/,I={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},z=/\\|'|\r|\n|\t|\u2028|\u2029/g;T.template=function(t,e,n){var i;n=T.defaults({},n,T.templateSettings);var o=new RegExp([(n.escape||H).source,(n.interpolate||H).source,(n.evaluate||H).source].join("|")+"|$","g"),r=0,s="__p+='";t.replace(o,function(e,n,i,o,a){return s+=t.slice(r,a).replace(z,function(t){return"\\"+I[t]}),n&&(s+="'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'"),i&&(s+="'+\n((__t=("+i+"))==null?'':__t)+\n'"),o&&(s+="';\n"+o+"\n__p+='"),r=a+e.length,e}),s+="';\n",n.variable||(s="with(obj||{}){\n"+s+"}\n"),s="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+s+"return __p;\n";try{i=new Function(n.variable||"obj","_",s)}catch(a){throw a.source=s,a}if(e)return i(e,T);var c=function(t){return i.call(this,t,T)};return c.source="function("+(n.variable||"obj")+"){\n"+s+"}",c},T.chain=function(t){return T(t).chain()};var F=function(t){return this._chain?T(t).chain():t};T.mixin(T),S(["pop","push","reverse","shift","sort","splice","unshift"],function(t){var e=r[t];T.prototype[t]=function(){var n=this._wrapped;return e.apply(n,arguments),"shift"!=t&&"splice"!=t||0!==n.length||delete n[0],F.call(this,n)}}),S(["concat","join","slice"],function(t){var e=r[t];T.prototype[t]=function(){return F.call(this,e.apply(this._wrapped,arguments))}}),T.extend(T.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}})}).call(this)},{}],25:[function(t,e,n){"undefined"!=typeof window&&"function"!=typeof window.requestAnimationFrame&&(window.requestAnimationFrame=window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t){setTimeout(t,1e3/60)}),Leap=t("../lib/index")},{"../lib/index":11}]},{},[25]),$(function(){$("#year1990").mouseover(function(){$("#num2000_1, #num2000_2, #num2000_3").attr("style","display:none;"),$("#num2015_1, #num2015_2, #num2015_3, #num2015_4").attr("style","display:none;"),$("#num1990_1").attr("style","margin-top:-50px"),$("#num1990_2").attr("style","margin-top:-70px"),$("#num1990_3").attr("style","margin-top:-90px"),$("#num1990_1, #num1990_2, #num1990_3").stop().fadeIn("slow").animate({"margin-top":0},1e3,"swing",function(){setTimeout(function(){$("#num1990_1, #num1990_2, #num1990_3").stop().fadeOut("slow")},3e3)})}),$("#year2000").mouseover(function(){$("#num1990_1, #num1990_2, #num1990_3").attr("style","display:none;"),$("#num2015_1, #num2015_2, #num2015_3, #num2015_4").attr("style","display:none;"),$("#num2000_1").attr("style","margin-top:-50px"),$("#num2000_2").attr("style","margin-top:-70px"),$("#num2000_3").attr("style","margin-top:-90px"),$("#num2000_1, #num2000_2, #num2000_3").stop().fadeIn("slow").animate({"margin-top":0},1e3,"swing",function(){setTimeout(function(){$("#num2000_1, #num2000_2, #num2000_3").stop().fadeOut("slow")},3e3)})}),$("#year2015").mouseover(function(){$("#num1990_1, #num1990_2, #num1990_3").attr("style","display:none;"),$("#num2000_1, #num2000_2, #num2000_3").attr("style","display:none;"),$("#num2015_1").attr("style","margin-top:-50px"),$("#num2015_2").attr("style","margin-top:-70px"),$("#num2015_3").attr("style","margin-top:-90px"),$("#num2015_4").attr("style","margin-top:-110px"),$("#num2015_1, #num2015_2, #num2015_3, #num2015_4").stop().fadeIn("slow").animate({"margin-top":0},1e3,"swing",function(){setTimeout(function(){$("#num2015_1, #num2015_2, #num2015_3, #num2015_4").stop().fadeOut("slow")},3e3)})})}),THREE.OrbitControls=function(t,e){function n(){return 2*Math.PI/60/60*f.autoRotateSpeed}function i(){return Math.pow(.95,f.zoomSpeed)}function o(t){if(f.enabled!==!1){if(t.preventDefault(),t.button===f.mouseButtons.ORBIT){if(f.noRotate===!0)return;A=N.ROTATE,v.set(t.clientX,t.clientY)}else if(t.button===f.mouseButtons.ZOOM){if(f.noZoom===!0)return;A=N.DOLLY,M.set(t.clientX,t.clientY)}else if(t.button===f.mouseButtons.PAN){if(f.noPan===!0)return;A=N.PAN,b.set(t.clientX,t.clientY)}A!==N.NONE&&(document.addEventListener("mousemove",r,!1),document.addEventListener("mouseup",s,!1),f.dispatchEvent(z))}}function r(t){if(f.enabled!==!1){t.preventDefault();var e=f.domElement===document?f.domElement.body:f.domElement;if(A===N.ROTATE){if(f.noRotate===!0)return;g.set(t.clientX,t.clientY),y.subVectors(g,v),f.rotateLeft(2*Math.PI*y.x/e.clientWidth*f.rotateSpeed),f.rotateUp(2*Math.PI*y.y/e.clientHeight*f.rotateSpeed),v.copy(g)}else if(A===N.DOLLY){if(f.noZoom===!0)return;T.set(t.clientX,t.clientY),S.subVectors(T,M),S.y>0?f.dollyIn():S.y<0&&f.dollyOut(),M.copy(T)}else if(A===N.PAN){if(f.noPan===!0)return;w.set(t.clientX,t.clientY),E.subVectors(w,b),f.pan(E.x,E.y),b.copy(w)}A!==N.NONE&&f.update()}}function s(){f.enabled!==!1&&(document.removeEventListener("mousemove",r,!1),document.removeEventListener("mouseup",s,!1),f.dispatchEvent(F),A=N.NONE)}function a(t){if(f.enabled!==!1&&f.noZoom!==!0&&A===N.NONE){t.preventDefault(),t.stopPropagation();var e=0;void 0!==t.wheelDelta?e=t.wheelDelta:void 0!==t.detail&&(e=-t.detail),e>0?f.dollyOut():0>e&&f.dollyIn(),f.update(),f.dispatchEvent(z),f.dispatchEvent(F)}}function c(t){if(f.enabled!==!1&&f.noKeys!==!0&&f.noPan!==!0)switch(t.keyCode){case f.keys.UP:f.pan(0,f.keyPanSpeed),f.update();break;case f.keys.BOTTOM:f.pan(0,-f.keyPanSpeed),f.update();break;case f.keys.LEFT:f.pan(f.keyPanSpeed,0),f.update();break;case f.keys.RIGHT:f.pan(-f.keyPanSpeed,0),f.update()}}function u(t){if(f.enabled!==!1){switch(t.touches.length){case 1:if(f.noRotate===!0)return;A=N.TOUCH_ROTATE,v.set(t.touches[0].pageX,t.touches[0].pageY);break;case 2:if(f.noZoom===!0)return;A=N.TOUCH_DOLLY;var e=t.touches[0].pageX-t.touches[1].pageX,n=t.touches[0].pageY-t.touches[1].pageY,i=Math.sqrt(e*e+n*n);M.set(0,i);break;case 3:if(f.noPan===!0)return;A=N.TOUCH_PAN,b.set(t.touches[0].pageX,t.touches[0].pageY);break;default:A=N.NONE}A!==N.NONE&&f.dispatchEvent(z)}}function l(t){if(f.enabled!==!1){t.preventDefault(),t.stopPropagation();var e=f.domElement===document?f.domElement.body:f.domElement;switch(t.touches.length){case 1:if(f.noRotate===!0)return;if(A!==N.TOUCH_ROTATE)return;g.set(t.touches[0].pageX,t.touches[0].pageY),y.subVectors(g,v),f.rotateLeft(2*Math.PI*y.x/e.clientWidth*f.rotateSpeed),f.rotateUp(2*Math.PI*y.y/e.clientHeight*f.rotateSpeed),v.copy(g),f.update();break;case 2:if(f.noZoom===!0)return;if(A!==N.TOUCH_DOLLY)return;var n=t.touches[0].pageX-t.touches[1].pageX,i=t.touches[0].pageY-t.touches[1].pageY,o=Math.sqrt(n*n+i*i);T.set(0,o),S.subVectors(T,M),S.y>0?f.dollyOut():S.y<0&&f.dollyIn(),M.copy(T),f.update();break;case 3:if(f.noPan===!0)return;if(A!==N.TOUCH_PAN)return;w.set(t.touches[0].pageX,t.touches[0].pageY),E.subVectors(w,b),f.pan(E.x,E.y),b.copy(w),f.update();break;default:A=N.NONE}}}function h(){f.enabled!==!1&&(f.dispatchEvent(F),A=N.NONE)}this.object=t,this.domElement=void 0!==e?e:document,this.enabled=!0,this.target=new THREE.Vector3,this.center=this.target,this.noZoom=!1,this.zoomSpeed=1,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.noRotate=!1,this.rotateSpeed=1,this.noPan=!1,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-(1/0),this.maxAzimuthAngle=1/0,this.noKeys=!1,this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40},this.mouseButtons={ORBIT:THREE.MOUSE.LEFT,ZOOM:THREE.MOUSE.MIDDLE,PAN:THREE.MOUSE.RIGHT};var p,d,f=this,m=1e-6,v=new THREE.Vector2,g=new THREE.Vector2,y=new THREE.Vector2,b=new THREE.Vector2,w=new THREE.Vector2,E=new THREE.Vector2,_=new THREE.Vector3,x=new THREE.Vector3,M=new THREE.Vector2,T=new THREE.Vector2,S=new THREE.Vector2,j=0,k=0,C=1,P=new THREE.Vector3,O=new THREE.Vector3,L=new THREE.Quaternion,N={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_DOLLY:4,TOUCH_PAN:5},A=N.NONE;this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom;var R=(new THREE.Quaternion).setFromUnitVectors(t.up,new THREE.Vector3(0,1,0)),H=R.clone().inverse(),I={type:"change"},z={type:"start"},F={type:"end"};this.rotateLeft=function(t){void 0===t&&(t=n()),k-=t},this.rotateUp=function(t){void 0===t&&(t=n()),j-=t},this.panLeft=function(t){var e=this.object.matrix.elements;_.set(e[0],e[1],e[2]),_.multiplyScalar(-t),P.add(_)},this.panUp=function(t){var e=this.object.matrix.elements;_.set(e[4],e[5],e[6]),_.multiplyScalar(t),P.add(_)},this.pan=function(t,e){var n=f.domElement===document?f.domElement.body:f.domElement;if(f.object instanceof THREE.PerspectiveCamera){var i=f.object.position,o=i.clone().sub(f.target),r=o.length();r*=Math.tan(f.object.fov/2*Math.PI/180),f.panLeft(2*t*r/n.clientHeight),f.panUp(2*e*r/n.clientHeight)}else f.object instanceof THREE.OrthographicCamera?(f.panLeft(t*(f.object.right-f.object.left)/n.clientWidth),f.panUp(e*(f.object.top-f.object.bottom)/n.clientHeight)):console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled.")},this.dollyIn=function(t){void 0===t&&(t=i()),f.object instanceof THREE.PerspectiveCamera?C/=t:f.object instanceof THREE.OrthographicCamera?(f.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom*t)),f.object.updateProjectionMatrix(),f.dispatchEvent(I)):console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled.")},this.dollyOut=function(t){void 0===t&&(t=i()),f.object instanceof THREE.PerspectiveCamera?C*=t:f.object instanceof THREE.OrthographicCamera?(f.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom/t)),f.object.updateProjectionMatrix(),f.dispatchEvent(I)):console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled.")},this.update=function(){var t=this.object.position;x.copy(t).sub(this.target),x.applyQuaternion(R),p=Math.atan2(x.x,x.z),d=Math.atan2(Math.sqrt(x.x*x.x+x.z*x.z),x.y),this.autoRotate&&A===N.NONE&&this.rotateLeft(n()),p+=k,d+=j,p=Math.max(this.minAzimuthAngle,Math.min(this.maxAzimuthAngle,p)),d=Math.max(this.minPolarAngle,Math.min(this.maxPolarAngle,d)),d=Math.max(m,Math.min(Math.PI-m,d));var e=x.length()*C;e=Math.max(this.minDistance,Math.min(this.maxDistance,e)),this.target.add(P),x.x=e*Math.sin(d)*Math.sin(p),x.y=e*Math.cos(d),x.z=e*Math.sin(d)*Math.cos(p),x.applyQuaternion(H),t.copy(this.target).add(x),this.object.lookAt(this.target),k=0,j=0,C=1,P.set(0,0,0),(O.distanceToSquared(this.object.position)>m||8*(1-L.dot(this.object.quaternion))>m)&&(this.dispatchEvent(I),O.copy(this.object.position),L.copy(this.object.quaternion))},this.reset=function(){A=N.NONE,this.target.copy(this.target0),this.object.position.copy(this.position0),this.object.zoom=this.zoom0,this.object.updateProjectionMatrix(),this.dispatchEvent(I),this.update()},this.getPolarAngle=function(){return d},this.getAzimuthalAngle=function(){return p},this.domElement.addEventListener("contextmenu",function(t){t.preventDefault()},!1),this.domElement.addEventListener("mousedown",o,!1),this.domElement.addEventListener("mousewheel",a,!1),this.domElement.addEventListener("DOMMouseScroll",a,!1),this.domElement.addEventListener("touchstart",u,!1),this.domElement.addEventListener("touchend",h,!1),this.domElement.addEventListener("touchmove",l,!1),window.addEventListener("keydown",c,!1),this.update()},THREE.OrbitControls.prototype=Object.create(THREE.EventDispatcher.prototype),THREE.OrbitControls.prototype.constructor=THREE.OrbitControls;var playFlagSyncer={},playCurrentSyncer=null;window.onload=function(){!function(){function t(){var t=document.getElementById(playCurrentSyncer);null!=t&&(t.pause(),t.currentTime=0)}for(var e="sounds",n="./sounds/",i=document.getElementsByClassName(e),o=0,r=i.length;r>o;o++)i[o].onmouseover=function(){var e=this.getAttribute("data-file");if("undefined"==typeof playFlagSyncer[e]||1!=playFlagSyncer[e]){var i=document.createElement("audio");i.id=e,i.canPlayType("audio/mp3")?i.src=n+e+".mp3":i.canPlayType("audio/wav")&&(i.src=n+e+".wav"),document.body.appendChild(i)}else t();return document.getElementById(e).play(),playCurrentSyncer=e,playFlagSyncer[e]=1,!1}}()};